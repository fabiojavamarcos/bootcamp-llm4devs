Util_x,Network_x,Interpreter_x,Error Handling_x,Lang_x,i18n_x,Setup_x,Logic_x,IO_x,Security_x,Event Handling_x,App_x,Author,prNumber,Util_y,Network_y,Interpreter_y,Error Handling_y,Lang_y,i18n_y,Setup_y,Logic_y,IO_y,Security_y,Event Handling_y,App_y,Title,Body,Comments
1,0,0,1,0,1,0,1,0,0,1,1,Tokuhiro Matsuno, 1810 1813 571,1,1,0,1,0,1,0,1,1,0,0,1, Revert  Fixes #1587 : Remove unnecessary loop from InjectingAnnotationEngine Fixes #1771: Upgrade byte-buddy to 1.10.2 (from 1.9.10) Pretty print primitive and wrappers types in Maps, Reverts mockito/mockito#1588 Related to #1631   Here s a pseudo code to describe the issues around this issue.  # Before 2.23.15:	      while (clazz != Object.clazz) { 	val mocks = aggregateSpyOrMockFields(clazz.getMockFields())    val fields = aggregateInjectMocksFields(clazz)  	val ret = tryConstructorInjection(clazz  fields  mock)    if (! ret.fieldWasInitializedUsingConstructorInjection()) {     trySetterOrPropertyInjection(clazz  fields  mock)    } 	clazz = clazz.getSuperclass()  }     # After 2.23.15:     	val mocks = aggregateSpyOrMockFields(clazz.getMockFields())    val fields = aggregateInjectMocksFields(clazz)  	val ret = tryConstructorInjection(clazz  fields  mock)    if (! ret.fieldWasInitializedUsingConstructorInjection()) {     trySetterOrPropertyInjection(clazz  fields  mock)    }      # Details  Before 2.23.15  if the  @InjectMocks  field has a field that not listed in the constructor argument will fill by setter/property injection at the 2nd loop ðŸ˜ƒ It may not the expected behaviors by Mockito authors  but some users  code depends on this behavior.  My suggestion is to revert the [Fixes #1587 : Remove unnecessary loop from InjectingAnnotationEngine by LihMeh Â· Pull Request #1588 Â· mockito/mockito Â· GitHub](https://github.com/mockito/mockito/pull/1588) at this time. Release notes: https://github.com/raphw/byte-buddy/releases/tag/byte-buddy-1.10.2 https://github.com/raphw/byte-buddy/releases/tag/byte-buddy-1.10.1 https://github.com/raphw/byte-buddy/releases/tag/byte-buddy-1.10.0 https://github.com/raphw/byte-buddy/releases/tag/byte-buddy-1.9.16 https://github.com/raphw/byte-buddy/releases/tag/byte-buddy-1.9.15 https://github.com/raphw/byte-buddy/releases/tag/byte-buddy-1.9.14 https://github.com/raphw/byte-buddy/releases/tag/byte-buddy-1.9.13 https://github.com/raphw/byte-buddy/releases/tag/byte-buddy-1.9.12 https://github.com/raphw/byte-buddy/releases/tag/byte-buddy-1.9.11  Relevant commits: raphw/byte-buddy@byte-buddy-1.9.10...byte-buddy-1.10.2 check list - [x] PR should be motivated  i.e. what does it fix  why  and if relevant how - [x] If possible / relevant include an example in the description  that could help all readers      including project members to get a better picture of the change - [x] Avoid other runtime dependencies - [x] Meaningful commit history   intention is important please rebase your commit history so that each      commit is meaningful and help the people that will explore a change in 2 years - [x] Read the [contributing guide](https://github.com/mockito/mockito/blob/master/.github/CONTRIBUTING.md) - [x] Mention  Fixes #<issue number>  in the description _if relevant_ - [x] At least one commit should mention  Fixes #<issue number>  _if relevant_  In following case  user can t understand the difference between expected and actual.  Code:      @Test public void foo() {     Foo m = mock(Foo.class)      m.foo(new HashMap<String  Object>(){{         put( hoge   4)      }})      verify(m).foo(new HashMap<String  Object>(){{         put( hoge   4L)      }})  }  public static class Foo {     void foo(Map<String  Object> map) {     } }      Output:      Argument(s) are different! Wanted: foo.foo(() {hoge=4})  -> at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) Actual invocation has different arguments: foo.foo(() {hoge=4})  -> at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)      If mockito outputs the  L  suffix for long values  user can understand the difference easily.  After this commit  the output will be following:      Argument(s) are different! Wanted: foo.foo({ hoge =4L})  -> at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) Actual invocation has different arguments: foo.foo({ hoge =4})  -> at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)      This will fix #570,
1,0,0,1,0,1,0,1,1,0,0,1,Fr Jeremy Krieg, 1644 1667 1723,1,1,0,1,1,1,0,1,0,0,0,1, VerificationCollector to handle non-matching args and other assertions Improved IDE experience for JUnit5 - visual comparison failure Change implementation of ExceptionFactory to explicitly test for dependent classes, This fix for #1642 widens the catch in  VerificationCollectorImpl  so that it will catch any  AssertionError   rather than just  MockitoAssertionError . In this way  any comparison failures (such as the built-in argument comparison when running under JUnit) will also be collected rather than propagating through to the test framework.  There are also two commits which are more cosmetic improvements to  VerificationCollectorImplTest :  * Rename  assertAtLeastOneFailure()  to  assertExactlyOneFailure()  (more accurate description of what it does). * Change  Assert.fail()  to AssertJ s  assertBecauseExceptionWasNotThrown()  (produces better diagnostics in the case of a failure). When JUnit5+Mockito is used in modern IDE (IDEA  Eclipse) we now show  visual  comparison failure pop-up for certain Mockito exceptions (such as ArgumentsAreDifferent).  Fixes #1663. The original implementation of conditional OpenTest4J support (#1667) relied on some implicit behaviour of the Java classloader to generate and catch the exception at the right time. It seems that this behaviour is not always exactly replicated in all environments - for example  in #1716  where Mockito was being used in an instrumentation test that was being run on an Android emulator.  The new implementation is a bit more direct in how it tests for the dependent classes. The existing test cases still pass  and @matejdro confirmed that this fixed his problem.  Fixes #1716.,
1,0,0,1,0,0,0,1,0,0,0,1,Michael Schieder, 2236,1,0,0,1,0,0,0,1,0,0,0,1, Bugfix/2235 verify on a wrapped mock fails, PR for #2235: verify() on a wrapped mock fails with UnfinishedVerificationException,
1,0,0,1,0,0,1,1,0,0,1,1,Slawomir Jaranowski, 2140,1,1,0,1,0,1,1,1,0,0,1,1, Endorsed MockitoTestNGListener in the documentation, After the latest changes in MockitoTestNGListener I sure that can be used without worry.  check list   - [x] Read the [contributing guide](https://github.com/mockito/mockito/blob/release/3.x/.github/CONTRIBUTING.md)  - [x] PR should be motivated  i.e. what does it fix  why  and if relevant how  - [x] If possible / relevant include an example in the description  that could help all readers        including project members to get a better picture of the change  - [x] Avoid other runtime dependencies  - [x] Meaningful commit history   intention is important please rebase your commit history so that each        commit is meaningful and help the people that will explore a change in 2 years  - [x] The pull request follows coding style  - [ ] Mention  Fixes #<issue number>  in the description _if relevant_  - [ ] At least one commit should mention  Fixes #<issue number>  _if relevant_,
1,1,0,1,0,1,1,1,1,0,1,1,Tim van der Lippe, 1227 1228 1238 1247 1350 1565 1586 1612 1617 1635 1641 1646 1648 1680 1690 1701 1790 1807 1811 1819 1820 1832 1845 1858 1862 1878 215 286 287 288 1934 1945 389 436 444 491 492 2227 2248 2259 2277 556 557 639 2292 872 1027 1041 1219 1220,1,1,1,1,1,1,1,1,1,1,1,1, Update license plugin and add missing license headers Add @CheckReturnValue to stubbing/verification methods Backport fixes release/2.x to master Remove several container classes and inline code Support local parameters in test methods with JUnit Jupiter Prevent StackOverflowError when processing reversed generics Add some missing  @Deprecated  annotations Return null instead of causing a CCE Fix issue with mocking of java.util.* classes Fix handling of generics in ReturnsMocks Fix returns mocks for final classes Add back getArgument(int  Class) to circumvent compilation issues Prevent NPE in findTypeFromGenericInArguments Fix handling of generic Void type for doNothing() Add ErrorProne MockitoInternalUsage checker Show multiple invocations on argumentsAreDifferent Enable spotless to automatically format our source code Add default implementation for VerificationMode#description Apply consistent import ordering with spotless Deprecate MockitoHamcrest Indent with spaces using spotless Add matchers for incompatible type matchers Revert  Add Duration overloads. Fixes #1815 Add TestRule to MockitoJUnit Revert  Performance optimization by using Method.getParameterCount() where possible Revert  Fixed undetected unused stubbing when matching previous stubbed call Improves InjectMocks behavior when injectee has multiple fields of the same type Add new API method to reset invocations of a mock  while maintaining all existing stubbing Implement VerificationCollector which can collect multiple verifications. Add optional answer to support mocked Builders Use google-java-format in spotless [Travis] Replace JDK 9/10 with 14 Lazily verify without calling collector.verify() Clean up issues reported by IntelliJ Add PARAMETER ElementType to @Mock Deprecate whitebox and corresponding verboserunner and junitfailurehaâ€¦ Revert  Remove deprecated method Add missing Deprecated annotation Fix thread race condition But invoked here  lists the invocation parameters Apply automated ErrorProne fixes Move Mockito internal classes to internal package Replace or remove code.google.com links in documentation Update Travis configuration to also build on oraclejdk9 Fix stackoverflow in ArgumentsAreDifferent reporting Prepare Android library for publication and bump version to 2.6.0 Fix some issues reported by SonarQube Backport fixes of release/2.x to master Add regression test for issue #1174 Backport fixes from release/2.x to master, The license plugin could be updated to later versions  as we dropped JDK6 on Travis. Moreover  quite some licenses were reported missing  so I ran  ./gradlew licenseFormatMain licenseFormatTest  to add them. Introduce a new annotation  @CheckReturnValue  and add this to methods like  when  and  verify  such that static analysis can verify the value is actually used (http://errorprone.info/bugpattern/CheckReturnValue). This makes sure developers can get warnings on build-time instead of run-time (with our internal  validateState )  Fixes #1130 - Update licenses - Remove unused  buildSrc  - Remove old gradle files - Add some more tests - Fix coverage Remove several classes that were containers for code that is easier to be inlined. They were only referenced once  or never at all. This makes it easier to reason about the code  while also maintaining less code and classes.  Closes #904 Note that this implementation differs from the prototype implementation of the JUnitTeam (https://github.com/junit-team/junit5-samples/blob/7bf40178345d5ca837579c8ddb8c025401a98788/junit5-mockito-extension/src/main/java/com/example/mockito/MockitoExtension.java#L41-L73). Instead  it will do not do any parameter resolution between test methods.  Fixes #1348 When processing the reverse method  the type parameters are actually reversed compared to the type parameters in the class. This subsequently confuses GenericMetadataSupport  as it creates a cycle in  contextualActualTypeParameters . In that case A resolves to B  while B resolves to A.  The root cause is that we are processing type parameters of methods  while we already processed them in the class declaration. Therefore  ignore any type parameters if we already derived the appropriate contextual type parameter. ErrorProne caught this. We correctly had them on most of the deprecated methods  but not on all of them. This solves a large number of edge-cases where  null  will actually remove the runtime ClassCastException. This essentially negates the whole MockitoCast ErrorProne check. We can still not support every use case  but causing a NPE instead of a CCE does not seem to make this worse.  I am still running internal tests within Google to see if there are any regressions  but I already saw that some of the test failures we had with ByteBuddy were resolved with this particular patch.  Note that this now fully closes #357. A previous PR resolved the same issue with ReturnsSmartNulls: #1576.  Fixes #357 Fixes #1615  I hope the test is correct. At least it failed before and succeeds now... ReturnsMocks was exhibiting the same problems as we previously had with ReturnsSmartNulls. Extract that common behavior into a separate class and thus fix the issues with ReturnsMocks. The guard for final mocking was incorrect. It should have passed it on to MockitoCore. Since we have the InlineMockMaker  we can actually mock  so this check was incorrect. Also add  @NotExtensible  to several of our interfaces to document they are not intended to be subclassed.  Fixes #1609 There was only a single test failing on this. I think the issue was RETURNS_SMART_NULLS in combination with an ArgumentCaptor  but couldn t figure that part out. At least this fixes prevented the NPE. When the return type bound to a generic type resolved to Void   doNothing()  would still throw an exception. Update the  isVoid  implementation to also handle generic return types. This checker will warn on any usage of a Mockito internal symbol. Since we do not guarantee API stability on symbols in our internal packages  users should not rely on them. This checker can be used to enforce that they are unused. This is the reconciliation of #1556 with the tests fixed and implementation rebased on  release/2.x .  Fixes #1542 Spotless [1] has been used by various popular open source projects  including JUnit [2]. While working on Mockito inside of Google  I discovered that our formatting is inconsistent. We can use Spotless to automatically take care of that.  To be able to format the source code  run  ./gradlew spotlessApply  This check runs on Travis to make sure code remains formatted. This should also reduce the amount of trouble with the CheckStyle linter  as Spotless will automatically resolve these issues.  On purpose  the spotless configuration is quite minimal. The current configuration is mostly a reflection on the current state of affairs. We can later discuss different configuration options and how we can integrate them.  [1]: https://github.com/diffplug/spotless/tree/master/plugin-gradle [2]: https://github.com/junit-team/junit5/blob/3f491f3148d2c745808fc75b0a802b60243e104e/build.gradle.kts#L124-L144 This method was added in Mockito 2 ([1]) and was implemented in all relevant subclasses. However  most subclasses do not implement a custom description.  Since we are now building on Java 8  we can ship this as a default method and remove all duplicate subclass implementations. As a side-effect  it allows users of Mockito 1 to migrate to Mockito 3 without additional breakages. (They could implement it  but VerificationModeFactory is internal and would require additional boilerplate)  [1]: https://github.com/mockito/mockito/pull/68 Spotless allows us to enforce a consistent import order. Configure it such that static imports are first and non-static imports afterwards. Within imports  java imports first  then javax  then all others.  This is consistent with the existing CONTRIBUTING.md guidelines  apart from the fact that static imports are first. (File has been updated). I would propose that makes more sense  but happy to discuss.  In any case  spotless already found inconsistent ordering within imports themselves  so that is already providing value for consistency.  I have also updated the CONTRIBUTING guidelines to explain how  ./gradlew spotlessApply  will fix a lot of issues without the developer having to worry about it. That should hopefully help newcomers make changes more confidently.  (The only 2 files that are interesting to you are the  build.gradle  and  .github/CONTRIBUTING.md . All other file changes were automatically performed after running  ./gradlew spotlessApply  locally.) This class was used during the migration period from Mockito 1 and Mockito 2  but is no longer necessary. To be able to remove our dependency on Hamcrest  we should remove MockitoHamcrest.  In response to #1817 Discovered in #1818 that (if new contributors are unaware of our indentation with 4 spaces)  spotless did not fix the formatting.  indentWithSpaces(4)  does just that and it actually found other formatting issues. We discovered that users run into issues with using the wrong Mockito matcher for arguments. Examples include  any(Integer.class)  instead of  anyInt()  and  anyInt()  instead of  anyFloat() . Users then run into cryptic run-time errors that are difficult to understand.  These ErrorProne checkers make these a compile warning  to warn the user before hand. They also provide the appropriate fixes that can be directly applied. Reverts mockito/mockito#1818  Fixes #1843 JUnit has two types of test rules: MethodRule and TestRule. The existing MockitoJUnit rule returns a MockitoRule which extends MethodRule. However  since this is not a TestRule  some features of JUnit do not nicely integrate with Mockito. For example  the RuleChain feature of JUnit only works on TestRules.  Therefore  add a separate entrypoint to MockitoJUnit which returns a TestRule that can be integrated with RuleChain. It introduces a separate interface to make this distinction clear. If we would change the existing MockitoRule to also extend TestRule  the JUnit logic would no longer run the MethodRule [1] and would thus break existing users.  [1]: https://github.com/junit-team/junit4/blob/2df7e0882128d551565f87f688bbe745d85aacba/src/main/java/org/junit/runners/BlockJUnit4ClassRunner.java#L402 Reverts mockito/mockito#1849  It breaks all downstream Android applications  see https://github.com/mockito/mockito/pull/1849#issuecomment-577139089 Reverts mockito/mockito#1847  Fixes #1877  Based on feedback in #1846 Fix to @InjectMocks which injected incorrectly when multiple fields of the same type could be injected into  but only supplying 1 mock. This makes sure that whenever there are multiple type candidates  it will hold off injecting if it finds a different field which has the correct matching name. Add new API method to reset invocations of a mock  while maintaining all existing stubbing.  ---  **EDIT by mockito team** : Fixes #183 It will report in the end the result of multiple statements. Fixes #124 When googling the mocking of builders  a lot of people said it was not possible with Mockito to support them in a clean way.  RETURNS_DEEPS_STUBS  does allow cascading  but can become quite fast very cumbersome. The added  RETURNS_SELF  will try to return itself by looking at the method  returnType  and compare this with the class of the mock. Google-java-format is an open source formatter [1]. It automatically formats source code based on the Google Java Style.  The Mockito source code to a very large extent already adheres to this style guide. While this PR in itself is large  many of the changes are related to string formatting and nested method calls. Most notably  google-java-format is an improvement over the current formatting strategy in that:  1. It handles comment formatting (e.g. spacing between comments) 2. It handles nested method calls. You can see the difference in our usage of the ByteBuddy API  which is now more consistent 3. It enforces the max-line length.  It essentially automates all of the styling rules we list in https://github.com/mockito/mockito/blob/release/3.x/.github/CONTRIBUTING.md#alignment As such  for new contributors it should be a lot easier (and less scary) to contribute to Mockito  as they no longer have to be concerned about formatting. Hopefully  this once again lowers the bar for external contributors who want to help the project  but would otherwise feel overwhelmed by the rules we have to adhere to. (If we wouldn t have these rules  it would be a lot harder for us to maintain a consistent and maintainable codebase).  The only interesting changes in this PR are those in  build.gradle . All other changes were auto-generated by running  ./gradlew spotlessApply .  Note that I disabled the formatting of Javadoc  as I think we should keep formatting that ourselves. We normally put a lot of time and effort in our Javadoc and changing that all at once seems like the wrong decision at this point in time.  [1]: https://github.com/google/google-java-format 9/10 are EOL since September 2018. 14 is the currently supported Java version. As originally requested in #287: lazily verify all  Mockito.verify(...)  calls inside JUnit test cases. Some general issues reported by IntelliJ. Mostly concerning modifiers and unused imports. TODO: Add a regression test to also show how this functionality can be used. CC @smoyer64  Fixes #438 A quick google showed that there are almost zero usages of this runner. Moreover it was relying on a very hackish implementation. I think we can do a better job by creating a new runner with JUnit 5 as part of #390. Therefore the intent is to deprecate these classes and remove them in Mockito 3.0.  Fixes #489 Simple git revert for an accidental removal of a deprecated api since 2.0 instead of 1.X.  Fixes #482. Discovered while trying to sync Mockito internally at Google. Discovered internally at Google. The culprit was a thread race condition around the usage of usedAt  which could race between setting the field and retrieving it. Supersedes and closes #2188 This is the result of running ErrorProne on the codebase. Most notably  it adds missing override annotations  adds private constructors for classes that should not be subclassed  removes redundant generic type specified and fixes handling of casts/instance checks. Fixes #551 Most links are replaced by their GitHub equivalent. Some links were pointing to issues on code.google.com  but given the large amount of documentation on these methods I decided to remove them.  Fixes #533 Let s see if this actually works. Testing for #520 When using Mockito without opentest4j  reporting an ArgumentsAreDifferent exception would throw a StackOverflowError when attempting to obtain the message from the exception.  The root problem was that super.toString() would call its own getMessage(). Instead  we should obtain the message from the super  to avoid the circular call. References first step of #848 Colleague students ran SonarQube on Mockito. These were some easy fixes I was able to do  no extreme value. I will open an issue regarding a different and potentially more serious issue. Yeah  we did this quite some time ago and this merge was hell. I hope I did not screw anything up. There are still 7 test failures  but I have to get dinner now. Please review this PR very carefully  to make sure I did not introduce regressions into master :sob: Regression that shows the issue of #1174. I am unable to reproduce this locally. Let s see what Travis says.  Closes #1174 Because we should do this more frequent :joy:,
1,0,0,1,0,0,0,1,0,0,0,1,Ilmir Usmanov, 2280,1,0,0,1,0,1,0,1,0,0,1,0, Support mocking of function with Kotlin inline classes, Despite functions with inline class parameters being already supported  there were not tests for it. Thus  add them.  The other part is functions  returning inline classes. There can be several kinds of inline classes - with primitive underlying type (nullable or not-null) and reference types (nullable or not-null). Also  a function can return either nullable of not-null inline class. If a function returns nullable inline class  we do not do anything special - the function s signature contains inline class. However  if the function returns not-null inline class  its signature contains underlying type  thus  we need to unbox the inline class (i.e. get underlying type s value) to mock the return value.  For example  if we have the following inline class    inline class IC(val i: Int)  and we want to mock return value of a function  returning the inline class    fun returnsIC(): IC  like     when (mock.returnsIC()).thenReturn(IC(1))  then if we do not unbox the argument of  thenReturn  function  we get error about incompatible types.  The only issue  however  is that we cannot check  whether the function indeed returns  IC   unless we use kotlin.reflect. So  the following code will work.    fun returnsInt(): Int     when (mock.returnsInt()).thenReturn(IC(1))  Fixes issue #1930  <!-- Hey   Thanks for the contribution  this is awesome. As you may have read  project members have somehow an opinionated view on what and how should be Mockito  e.g. we don t want mockito to be a feature bloat. There may be a thorough review  with feedback -> code change loop. --> <!-- Which branch :  - On mockito 3.x  make your pull request target  release/3.x  - On mockito 2.x  make your pull request target  release/2.x  (2.x is in maintenance mode) --> <!-- If you have a suggestion for this template you can fix it in the .github/PULL_REQUEST_TEMPLATE.md file --> ## Checklist   - [X] Read the [contributing guide](https://github.com/mockito/mockito/blob/release/3.x/.github/CONTRIBUTING.md)  - [X] PR should be motivated  i.e. what does it fix  why  and if relevant how  - [X] If possible / relevant include an example in the description  that could help all readers        including project members to get a better picture of the change  - [X] Avoid other runtime dependencies  - [X] Meaningful commit history   intention is important please rebase your commit history so that each        commit is meaningful and help the people that will explore a change in 2 years  - [X] The pull request follows coding style  - [X] Mention  Fixes #<issue number>  in the description _if relevant_  - [X] At least one commit should mention  Fixes #<issue number>  _if relevant_,
1,0,0,1,0,0,0,1,0,0,0,1,Emory Merryman, 47,0,0,0,0,0,1,0,0,0,0,0,0, Issue484 fix, This fixes the issue when comparing 2 identical objects which throw an exception in their equals method.,
1,1,0,1,0,0,1,1,0,0,0,1,Anuraag Agrawal, 1391,1,0,0,0,0,0,0,0,0,0,0,1, Make MockitoExtension constructor public, It is possible to register an extension for automatic use using Java s  ServiceLoader  mechanism.  https://junit.org/junit5/docs/current/user-guide/#extensions-registration-automatic  Some projects may want to provide their own  META-INF  file to avoid tediously adding  MockitoExtension  to tests since it is very common. However   ServiceLoader  requires the class to have a no-args *public* constructor  so the current extension cannot be used with the  ServiceLoader  mechanism.  Fixes #1390  check list   - [X] Read the [contributing guide](https://github.com/mockito/mockito/blob/release/2.x/.github/CONTRIBUTING.md)  - [X] PR should be motivated  i.e. what does it fix  why  and if relevant how  - [X] If possible / relevant include an example in the description  that could help all readers        including project members to get a better picture of the change  - [X] Avoid other runtime dependencies  - [X] Meaningful commit history   intention is important please rebase your commit history so that each        commit is meaningful and help the people that will explore a change in 2 years  - [X] The pull request follows coding style  - [X] Mention  Fixes #<issue number>  in the description _if relevant_  - [X] At least one commit should mention  Fixes #<issue number>  _if relevant_,
1,0,0,1,0,1,0,1,0,0,0,1,Jan Mosig, 2193,0,0,0,0,0,0,0,1,0,0,0,1, Fixes #2154 : java.lang.Object is now instrumented again, Seems like       // The object type does not ever need instrumentation. targets.remove(Object.class)       in  org.mockito.internal.creation.bytebuddy.InlineBytecodeGenerator.triggerRetransformation(Set<Class<?>>  boolean)  was a bit over the top  i. e. it does seem to break mocking of  toString  when inherited from  java.lang.Object .  I added a test for this which should have been there in the first place. Due to this  I am still not sure if removing the line is safe  even if the whole test suite is green. Please review carefully.,
1,0,0,0,0,0,0,1,0,0,0,1,Michael Keppler, 1792,0,0,0,0,0,1,0,0,0,0,0,0, Fix grammar, Past tense of  to nest  is  nested . Also fix plenking.,
1,0,0,1,0,1,0,1,0,0,0,1,Walter Scott Johnson, 1536,1,0,0,1,0,0,0,1,0,0,0,1, Allow delegating to non-public methods for AdditionalAnswers#delegatesTo, Fixes an issue where doing  delegatesTo(new AnonymousClass() {})  would cause an IllegalAccessException  and other access-related issues.  (See https://github.com/mockito/mockito/pull/1535 - Sorry  wasn t aware that you can t change the PR source branch.),
1,0,0,1,0,0,1,1,0,0,1,1,Sangwoo Lee, 1434 1436 1439 1440 1458 1463,1,1,0,1,0,0,1,1,0,0,1,1, Javadoc: Update broken code example Javadoc: Update code example (ignoreStubs) Javadoc: #1438 Update ignoreStubs to include strictness Javadoc: Correct wrong links and code examples Add StubbingLookupEvent and Notifier (a part of #793) Prevent stubOnly() from being verified (#1460), It updates a broken code example in Javadoc. I just copied the example from [Answer.java](https://github.com/mockito/mockito/blob/release/2.x/src/main/java/org/mockito/stubbing/Answer.java#L16) to [Mockito.java](https://github.com/mockito/mockito/blob/release/2.x/src/main/java/org/mockito/Mockito.java#L525). It updates the code example of  ignoreStubs  in Javadoc. - Correct wrong variable : From  mock  to  list  - Change call sequence : The existing one doesn t clearly describe the use of  ignoreStubs  with  inOrder . It updates  ignoreStubs()  docs to include  Strictness  information. (#1438) Some wrong links and code examples are corrected. This PR adds  StubbingLookupEvent  and  StubbingLookupNotifier  as a part of the issue #793. This PR adds assertion to verification methods to prevent stub-only mock from being verified (#1460) -  verify()  -  verifyNoMoreInteractions()  -  inOrder(),
1,0,0,1,0,1,1,1,0,0,0,1,Danny MÃ¶sch, 1787,1,1,0,1,0,0,1,1,0,0,1,1, Fixes #1786 : Clarify differences between  timeout  and  after, Tries to improve the JavaDoc for  timeout  to differentiate it from  after  directly in the first sentence.,
1,0,0,1,0,1,0,1,0,0,0,1,Lovro PandÅ¾iÄ‡, 38 44,1,1,0,1,0,0,1,1,0,0,1,1, New  then  method for BDD-style interaction testing Refactoring: removed then-verify, New feature in BddMockito for BDD then part of the test which allows mock behavior verification by using  Mockito#verify(Object) . For example we have classes Person and Bike:      java Bike bike = new Bike()  Person person = mock(Person.class)       and the following interaction      java person.ride(bike)  person.ride(bike)       Current (non BDD) behavior verification would go like:      java verify(person  times(2)).ride(bike)       This feature introduces the following way of verification:      java then(person).should(times(2)).ride(bike) Removed verify alias in BddMockito.,
1,0,0,1,0,0,0,1,0,0,0,1,Dmitriy Zaitsev, 746,1,1,1,1,0,1,1,1,1,1,1,1, Add missing copyright headers, - [x] Fixes #727  - [x] Add missing copyrights using [license-gradle-plugin](https://github.com/hierynomus/license-gradle-plugin). - [x] Updated only source files. Test files were skipped. Existing copyright headers were not modified.,
1,0,0,1,0,0,0,1,0,0,0,1,Tsuyoshi Murakami, 979 985,1,1,0,1,0,1,1,1,1,0,1,1, Fixes #974: Fix to get correct stubbing location with inline mocking Fixes #981: Update Javadoc about the  mockito-inline  artifact, - Fix StackTraceFilter to support inline mocking - Add one test to StackTraceFilterTest - Add StubbingLocationTest into inline subproject  This PR fixes #974. This PR fixes #981.  In the Javadoc  I write that the first version of  mockito-inline  is  2.7.6 . This artifact was actually offered in version  2.7.2   but  2.7.5  or earlier it did not work due to the issue #929  so I write like that.,
1,1,0,1,0,0,1,1,0,0,1,1,Eitan Adler, 1906 1907,1,0,0,1,0,1,1,1,1,0,0,1, [documentation] change deprecated warnings from 3.x -> 4.x [tests] use ArgumentMatchers over Matchers, Problem  With the release of mockito 3.x as a purely java language version change most of the comments referencing 3.x are wrong  Solution  Migrate the references to 3.x that I could find to 4.x  [ci skip-release]  - [x] Read the [contributing guide](https://github.com/mockito/mockito/blob/release/3.x/.github/CONTRIBUTING.md)  - [x] PR should be motivated  i.e. what does it fix  why  and if relevant how  - [x] If possible / relevant include an example in the description  that could help all readers        including project members to get a better picture of the change  - [x] Avoid other runtime dependencies  - [x] Meaningful commit history   intention is important please rebase your commit history so that each        commit is meaningful and help the people that will explore a change in 2 years  - [x] The pull request follows coding style  - [x] Mention  Fixes #<issue number>  in the description _if relevant_  - [x] At least one commit should mention  Fixes #<issue number>  _if relevant_ Problem Matchers are considered deprecated but our own tests still use them.  Solution Stop using using them. Replace with ArgumentMatchers  [ci skip-release]  check list   - [x] Read the [contributing guide](https://github.com/mockito/mockito/blob/release/3.x/.github/CONTRIBUTING.md)  - [x] PR should be motivated  i.e. what does it fix  why  and if relevant how  - [x] If possible / relevant include an example in the description  that could help all readers        including project members to get a better picture of the change  - [x] Avoid other runtime dependencies  - [x] Meaningful commit history   intention is important please rebase your commit history so that each        commit is meaningful and help the people that will explore a change in 2 years  - [x] The pull request follows coding style  - [/] Mention  Fixes #<issue number>  in the description _if relevant_  - [x] At least one commit should mention  Fixes #<issue number>  _if relevant_,
1,0,0,1,0,1,0,1,0,0,0,1,Sergey, 1762,1,0,0,0,0,1,0,1,1,0,0,0, Fixes #1758: Method GenericTypeExtractor#findGenericInterface always â€¦, â€¦returns first interface,
1,0,0,0,0,1,0,1,0,0,0,1,Alex Simkin, 1620 986,1,0,0,0,0,0,1,1,1,0,1,1, Fixes #1618 : Fix strict stubbing profile serialization support. Made CaturingMatcher threadsafe, When strict stubs profile is enabled  mock serialization doesn t work.  This PR fixes this problem. In my tests I faced two problems with current capturing matcher. 1. It exposes its internal store through  #getAllValues() . 2. Internal data store in CapturingMatcher is not threadsafe. Exposing internal store when interraction with mocked object isn t finished may produce all kind of weird exceptions in tests.,
1,1,0,1,0,0,0,1,0,0,1,1,Ryan Pickett, 1708,1,0,0,1,0,1,0,1,0,0,1,1, Fixes #1623 : Rename TooLittleActualInvocations, Rename the exception TooLittleActualInvocations to TooFewActualInvocations as this is more correct English. As this exception is public API  we rename by subclassing and deprecating the original. Rename all tests and internal methods that were referencing the old name by aligning with the new name.  check list   - [x] Read the [contributing guide](https://github.com/mockito/mockito/blob/release/2.x/.github/CONTRIBUTING.md)  - [x] PR should be motivated  i.e. what does it fix  why  and if relevant how  - [ ] If possible / relevant include an example in the description  that could help all readers        including project members to get a better picture of the change  - [x] Avoid other runtime dependencies  - [x] Meaningful commit history   intention is important please rebase your commit history so that each        commit is meaningful and help the people that will explore a change in 2 years  - [x] The pull request follows coding style  - [x] Mention  Fixes #<issue number>  in the description _if relevant_  - [x] At least one commit should mention  Fixes #<issue number>  _if relevant_,
1,1,0,1,0,0,1,1,0,0,1,1,Naoki Takezoe, 1931,1,0,0,1,0,1,0,1,0,0,1,0, Update report message to use any() instead of anyObject(), Because  anyObject()  has already been deprecated  it would be better to push to use  any()  instead.  > Hey   >  > Thanks for the contribution  this is awesome. > As you may have read  project members have somehow an opinionated view on what and how should be > Mockito  e.g. we don t want mockito to be a feature bloat. > There may be a thorough review  with feedback -> code change loop. >  > Which branch :  > - On mockito 3.x  make your pull request target  release/3.x  > - On mockito 2.x  make your pull request target  release/2.x  (2.x is in maintenance mode) > > _This block can be removed_ > _Something wrong in the template fix it here  .github/PULL_REQUEST_TEMPLATE.md    check list   - [x] Read the [contributing guide](https://github.com/mockito/mockito/blob/release/3.x/.github/CONTRIBUTING.md)  - [x] PR should be motivated  i.e. what does it fix  why  and if relevant how  - [ ] If possible / relevant include an example in the description  that could help all readers        including project members to get a better picture of the change  - [x] Avoid other runtime dependencies  - [x] Meaningful commit history   intention is important please rebase your commit history so that each        commit is meaningful and help the people that will explore a change in 2 years  - [x] The pull request follows coding style  - [ ] Mention  Fixes #<issue number>  in the description _if relevant_  - [ ] At least one commit should mention  Fixes #<issue number>  _if relevant_,
1,0,0,1,0,0,0,1,0,0,0,1,Robert Chmielowiec, 1978,1,1,0,1,0,0,1,1,0,0,1,1, Fix Javadoc invalid syntax, Escape @ character to html entity.  Fixes https://github.com/mockito/mockito/issues/1977,
1,0,0,0,0,0,0,1,0,0,0,1,Andrei Silviu Dragnea, 1847 1928,1,0,0,1,0,1,1,1,0,0,1,1, Fixed undetected unused stubbing when matching previous stubbed call JUnit 5 strict stubs check should not suppress the regular test failure, Fixes #1846 If the test fails  MockitoExtension should not check for strict stubs at the end of the test  because the possible UnnecessaryStubbingException will end up as a suppressed exception on the test s initial failure.,
1,0,0,1,0,0,0,1,0,0,0,1,Hans Joachim Desserud, 511 525 673,1,0,0,0,0,1,0,1,1,0,0,1, Fix some warnings Add regression test for #508 Removed duplicate test, Fixed various warnings  mostly unused imports  but also a couple of unnecessary semicolons and interface modifiers.   ./gradlew build  built successfully. As mentioned in the bug report for #508   adds a test which would catch this issue if it happened to regress in the future. Hello again :p   I originally requested this test to be added in #525 after the underlying problem had been resolved. While browsing the code now  I discovered that it had already been added (as https://github.com/mockito/mockito/blob/master/src/test/java/org/mockitousage/bugs/DiamondInheritanceIsConfusingMockitoTest.java). This probably doesn t need to be tested twice  so I ve removed the duplicate test.,
1,0,0,1,0,1,0,1,0,0,0,0,Roi Atalla, 434,1,0,0,1,0,0,1,1,0,0,0,1, Very tiny typo., Missing word in error message.,
1,0,0,1,0,1,0,1,0,0,0,1,Christoph Dreis, 1849,1,0,0,1,0,1,1,1,1,0,1,1, Performance optimization by using Method.getParameterCount() where possible, Hi   as described in #1848 we could make use of  Method.getParameterCount()  in order to save some overhead from unnecessary cloning caused by  Method.getParameterTypes() .  As this is my first contribution to Mockito  let me know if I can do something to help.  Let me know what you think. Cheers  Christoph,
1,0,0,1,0,0,0,1,0,0,0,1,David J. M. Karlsen, 386,1,0,0,1,0,0,0,1,0,0,0,1, Remove deprecated code, Fixes for #374 - more left though.,
1,0,0,0,0,1,0,1,0,0,0,1,Eugene Ivakhno, 229,1,0,0,0,0,1,0,1,0,0,0,0, Fixes #228: fixed a verify() call example in @Captor javadoc, nan,
1,0,0,1,0,1,1,1,0,0,0,1,Charles Munger, 2306 2312 2318,1,1,1,1,0,1,0,1,1,0,0,1, Use the parent classloader if the context classloader is a child of it. Undo parent for MultipleParentsClassLoader Check package-privacy of method params, This should only affect cases that previously would have thrown an exception. Fixes #2303 66998ea7f81c6adf49983cea081586e19760b7a0 inadvertently undid a change from 9bc9be6d0fb1809346dcd02b22ced477816e0fc1  which breaks behavior under some classloaders that special-case mockito classes. Use of an explicit parent with  MultipleParentsClassLoader  appears to be discouraged in the documentation also.  Followup for #2303 This patch handles methods where an interface uses a package-private type as a param or return value - without it  the generated mock class will produce AbstractMethodError  since its methods do not actually override the methods of the interfaces.  Followup on #2303,
1,1,0,1,0,1,0,1,0,0,1,1,Marc Philipp, 1301 1672 1821,1,0,0,1,0,1,0,1,1,0,0,1, Extend MockitoSession(Builder) API to enable usage by testing frameworks Report initialization failures per test method Guard against multiple evaluations of before statement, The first commit in this PR fixes #1232. In the additional commits  I ve taken the liberty to implement my proposals from https://github.com/mockito/mockito/issues/445#issuecomment-358407562:  - Add  MockitoSessionBuilder.name(String)  to pass a name from the testing framework to the  MockitoSession  - Add  MockitoSessionBuilder.logger(MockitoSessionLogger)  to customize the logger used for hints/warnings produced when finishing mocking (useful for testing and to connect reporting capabilities provided by testing frameworks such as JUnit Jupiter) - Add  MockitoSession.finishMocking(Throwable)  to avoid potentially confusing warnings for failing tests - Add  MockitoSession.setStrictness(Strictness)  to change the strictness of the current session (there were two test cases requiring that)  Each of these changes is in a separate commit. Thus  it should be relatively easy to take only those changes that you think good  or just the first one to fix #1232.  To showcase that this new API is sufficient to implement an extension of a testing framework  I ve changed the  JUnitRule  implementation to use it. Prior to this commit   DefaultInternalRunner  threw an exception when  MockitoAnnotations.initMocks()  failed from the overridden  withBefores  method. Instead  it now returns a  Statement  that is responsible for initializing. Potential exceptions are then handled by JUnit  regardless whether version 4.12 or 4.13-beta-2 is used. Instead of reporting a class-level error  JUnit will now report a failure for each test method in such test classes.  Related issue: junit-team/junit4#1599   - [x] Read the [contributing guide](https://github.com/mockito/mockito/blob/release/2.x/.github/CONTRIBUTING.md)  - [x] PR should be motivated  i.e. what does it fix  why  and if relevant how  - [ ] If possible / relevant include an example in the description  that could help all readers        including project members to get a better picture of the change  - [x] Avoid other runtime dependencies  - [x] Meaningful commit history   intention is important please rebase your commit history so that each        commit is meaningful and help the people that will explore a change in 2 years  - [x] The pull request follows coding style  - [x] Mention  Fixes #<issue number>  in the description _if relevant_  - [x] At least one commit should mention  Fixes #<issue number>  _if relevant_ Some rules evaluate the base statement multiple times  e.g. to execute tests repeatedly. The changes made in #1672 led to an exception in such cases because the  MockitoListener  was registered multiple times. Now  we only add the listener the first time the statement is evaluated in order to restore the old behavior.  Fixes #1767.,
1,0,0,1,0,1,0,1,1,0,0,1,Ariel Isaac, 301,1,0,0,1,0,1,1,1,0,0,0,1, Refactor some utilities and TODO done, Hey guys  awesome framework +1 i ve been looking at the code and i did some improvements  also i did a TODO but i m not quite sure how to handle that null check it would be awesome if you could check it out @bric3 @szczepiq   Answers.java : private is not required  ClassPathLoader.java: Removed unnecessary imports ScenarioPrinter.java: Changed the string concat into another append MockHandlerFactory.java: Return statement changed to be inline ValuePrinter.java: TODO done  null check added  Edit  ReleaseNotesExtension : Made authToken a final String  Edit 2:  Some improvements to the ThreadTests :),
1,0,0,1,0,1,0,1,0,0,0,1,Urs Metz, 344,0,0,0,1,0,0,0,1,0,0,0,0, Show correct location of unwanted interaction with mock when using MockitoJUnitRule, This pull request by @indy5858 and me changes the stacktrace filtering so that when using  MockitoJUnitRule  the correct location of an unwanted interaction with a mock.  Before this commit the location on an unwanted interaction was not reported properly. Instead of      No interactions wanted here: -> at <package>.<TestClass>.<testMethod>(<TestClass.java>:<lineNumber>)      the assertion message said:      No interactions wanted here: -> at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:325)      The issue with the current behaviour in master is that all stacktrace elements above an element containing  org.mockito.  are removed. As  org.mockito.internal.junit.JUnitRule  fullfills this condition and comes below the  payload  (i.e. test code and code under test) stack elements the interesting part of the stack is filtered. In case the pull request #317 (which we only found after hacking on this) is merged this pull becomes obsolete except for the two tests that are added: - checking that the  payload  stack elements aren t removed from the stack and - a test for removal of the Byte Buddy stack elements.,
1,0,0,1,0,0,1,1,0,0,1,1,Vineet Kumar, 376 377,0,0,0,0,0,1,0,0,0,0,0,0, Fix typo in example in javadoc. Remove duplication., This is a trivial javadoc-only change  just fixing a typo. simple documentation-only change.,
1,0,0,1,0,0,1,1,0,0,1,1,Federico Fissore, 1733 1799 995,1,1,0,1,0,1,1,1,1,0,1,1, verifyNoInteractions guarantees no interactions with mock Fixes placeholder  3.x.x  version in javadoc with correct  3.0.1 verifyZeroInteractions guarantees zero interactions instead of just delegating to verifyNoMoreInteractions, With #995 I provided a fix to #977 and #989 However that PR targeted  master   which eventually became  old-3.x   and its code didn t make it into  release/3.x . #977 and #989 should be reopened.  I have back-ported that PR to target  release/3.x .  verifyZeroInteractions  is marked as  @Deprecated  and a new  verifyNoInteractions  is added. There are no breaking changes AFAIK  so this code is backwards compatible. Since I don t know if/when this code will ship  javadocs contain a placeholder  Since 3.x.x This is a small javadoc fix  When I contributed with #1733  I didn t know which version of mockito will have included it  so I left a placeholder  3.x.x  in the javadoc. I then forgot to update the code once  3.0.1  was tagged. Fixes #989   verifyZeroInteractions  no longer delegates to  verifyNoMoreInteractions  Instead  it fetches the number of invocations made to the mock and checks if they are zero  failing otherwise  I m not sure if the style of my code complies with mockito: please let me know what to change and where to look to make it more mockitoish,
1,0,0,0,0,1,0,1,0,0,0,0,Arend v. Reinersdorff, 1745 1092,1,1,0,1,0,0,1,1,0,0,1,1, Fixes #1743: Clarify default answer in 3.0.0 Fix link to Mockito JUnit rule heading, API changes postponed to 4.0.0. Default answer has not been changed in 3.0.0. nan,
1,0,0,0,0,1,0,1,0,0,0,0,Vladislav, 1125,1,1,0,1,0,0,1,1,0,0,1,1, Fix typo: Remove repeated  a, nan,
1,0,0,1,0,1,0,1,0,0,1,1,Dimos Raptis, 896,1,1,0,1,0,0,1,1,0,0,1,1, Clarify documentation for consecutive stubbing, Fixes #895  As of now  the documentation does not clarify the difference of behaviour between chaining multiple .thenReturn() statements and using multiple when/thenReturn statements  when someone attempts to perform consecutive stubbing.  I added a warning/clarification in the documentation with a corresponding example  so that it s more clear (especially for new users of Mockito).,
1,0,0,1,0,0,1,1,0,0,0,1,Marcin Grzejszczak, 29 30 56 59,1,0,0,1,0,1,0,1,1,0,1,1, Smarter constructor injection by choosing  biggest  constructor instead of the default one Deep stub style mocks can be serialized Fixed wrong javadoc for AdditionalAnswers Refactoring: Added casts to supress varargs warnings, See https://code.google.com/p/mockito/issues/detail?id=421  Added additional condition to sorting of constructors by checking amount of mockable constructor arguments See https://code.google.com/p/mockito/issues/detail?id=399 Fixed wrong javadoc for AdditionalAnswers nan,
1,0,0,1,0,1,0,1,0,0,1,1,Philip P. Moltmann, 1307 1320 1339,1,1,0,0,0,1,0,1,1,0,0,1, Update public API of InvocationFactory needed for Android static mocking Avoid bytebuddy import Issue to enable repackaging without bytebuddy Enable errorprone build, Fixes #1306  A real method might throw a Throwable  but the invocations produced by InvocationFactory call the real method via a Callable that can only throw a Exception.  Hence add a new method to InvocationFactory that allows to create invocations with a RealMethodBehavior == a Callable that throws a Throwable. This allows libs that use alternate mockmakers do cleanly exclude the bytebuddy subdirectory.  Test: grep -r -e  import org\.mockito\.internal\.creation\.bytebuddy\.[^\.]*$  src/main does not return anything  Offers workaround for #1112 - fix up issues found - placate error prone warning where we know we do something funky - Ignore two tests as it is not immediately clear what is broken   - org.mockitousage.bugs.varargs.VarargsNotPlayingWithAnyObjectTest#shouldNotAllowUsingAnyObjectForVarArgs   - org.mockito.internal.util.PrimitivesTest#should_check_that_value_type_is_assignable_to_wrapper_reference  NOTE: Please carefully review the changes made to the code. I fixed them up as good as I could but a real mockito expert need to verify them.,
1,0,0,1,0,1,0,1,0,0,0,1,Dmitry Timofeev, 1324,0,0,0,0,0,0,0,0,0,0,0,1, Improved stubbing internals and test coverage, Some improvements in exception-stubbing code:  - Clarify intentions in BaseStubbing:   - Replace an obsolete TODO with a clarifying comment and add some tests covering related test cases.   - Extract the code aborting the ongoing stubbing in a separate method that always throws. Use return  abortNullExceptionType  so that static-analysis tools (e.g.  IDEA) yield no false-positives.  - Clarify that ThrowsException always returns the _same_ throwable. The previous  #answer  implementation might give an illusion that  Throwable#fillInStackTrace  produces a new throwable  but that is not correct â€” it always returns  this . - Also  replace a possible NPE with a descriptive IllegalStateException.,
1,0,0,1,0,1,0,1,0,0,0,1,Bruno Bonanno, 1665,1,0,0,0,0,1,0,1,1,0,0,0, New public API: invocation.getArgumentsAsMatchers(), - New public API: invocation.getArgumentsAsMatchers()  useful for advanced integrations  such as mockito-scala - Some internal refactorings that provide temporary help with mockito-scala integration  Fixes #1664,
1,0,0,1,0,0,0,1,0,0,0,1,Ben Yu, 293 942 1157,1,1,0,1,0,0,1,1,1,0,1,1, Remove validateSerializable() Allow spying on interfaces so that it is convenient to work with Java 8 default methods Add tests to verify and show that @Spy can be used to allow stubbing/verification of List parameters using varargs., Fixes #245:  Remove serializable validation. Fixes #680 Hi  I thought about sending an email first but then figured that I d probably put in the test code as the example anyway  which is what this PR is all about.  I m not completely sure that there isn t already a better way to go about stubbing List params. If there are  I m happy to learn! :),
1,0,0,1,0,1,0,1,0,0,0,1,Dominik Stadler, 1781,1,0,0,0,0,0,0,1,0,0,0,1, Fixes #1780: Close file handle to avoid a file-handle-leak, Fix a small file-handle-leak which pops up when running tests with [file-leak-detector](https://file-leak-detector.kohsuke.org/)   Fixes #1780,
1,1,0,1,0,0,1,1,0,0,1,1,Stuart Blair, 953,0,0,0,1,0,0,1,0,0,0,0,0, Fix Javadocs on MockitoRule.java to correct an error on its usage., Fixing the Javadoc to reflect the API for MockitoJUnitRule  > Hey   >  > Thanks for the contribution  this is awesome. > As you may have read  project members have somehow an opinionated view on what and how should be > Mockito  e.g. we don t want mockito to be a feature bloat. > There may be a thorough review  with feedback -> code change loop. >  > Which branch :  > - On mockito 2.x  make your pull request target  release/2.x  > - On next mockito version make your pull request target  master  > > _This block can be removed_ > _Something wrong in the template fix it here  .github/PULL_REQUEST_TEMPLATE.md    check list   - [ ] Read the [contributing guide](https://github.com/mockito/mockito/blob/release/2.x/.github/CONTRIBUTING.md)  - [ ] PR should be motivated  i.e. what does it fix  why  and if relevant how  - [ ] If possible / relevant include an example in the description  that could help all readers        including project members to get a better picture of the change  - [ ] Avoid other runtime dependencies  - [ ] Meaningful commit history   intention is important please rebase your commit history so that each        commit is meaningful and help the people that will explore a change in 2 years  - [ ] The pull request follows coding style  - [ ] Mention  Fixes #<issue number>  in the description _if relevant_  - [ ] At least one commit should mention  Fixes #<issue number>  _if relevant_,
1,0,0,1,0,1,0,1,0,0,0,1,Kurt Alfred Kluever, 1818,1,1,0,1,0,0,1,1,0,0,1,1, Add Duration overloads. Fixes #1815, Add new  java.time.Duration -based public APIs to  Mockito    After   and  Timeout  and deprecate the corresponding  long -based public APIs. Plumb those  Duration  instances through the internals of Mockito.,
1,0,0,0,0,1,0,1,0,0,0,0,Christoph Wagner, 1720,0,0,0,1,0,0,0,1,0,0,0,1, Add missing  be  in javadoc, nan,
1,1,1,1,0,1,1,1,1,0,1,1,Brice Dutheil, 1624 5 24 103 202 234 235 238 239 240 280 495 496 510 528 560 592 617 646 693 711 734 747 748 771 803 811 819 821 826 827 830 839 868 885 897 905,1,1,0,1,1,1,1,1,1,0,1,1, Handle terminal type var with bounds Mock serialization/deserialization across classloader/JVM Avoided classloader issue when testing in Eclipse plugins environment Fixes issue #99 : RETURNS_DEEP_STUBS automatically tries to create serializable mocks Better protection against incompatible returned value of default answer  and get safely mock name Cannot instantiate type with public method of a public parent class having a non public types in signature Fixes #220 constructor invoking methods raise NPE Moves responsibility of isTypeMockable to MockMaker Rework stubbing api with consecutive vararg to avoid JDK7+ warnings Fixes coverage reports Reintroduce null check on MockUtil.isMock() Moves Reporter friendly exception factory to internal package Renames Matchers to ArgumentMatchers to avoid name clash with Hamcrest Matchers class Fixes #194 tweaks any matchers Missing generics info on collection matchers Fixes #554 : Checks.checkNotNull now throws IAE instead of NPE stylesheet-tweaks-for-openjdk6 Moves arity interfaces of java8 helper answers to public API Fixes #640 Warns user to upgrade if Java 8 version is to low Improved the format of arguments in verification failures when describing short and byte values Fixes #707  adds throwable to arity answers  also improved javadoc New nullable(Class<T>) matcher for convenient matching of nullable arguments Allow fluent usage of Mockito.framework() listeners methods Regroup Junit classes in junit packages Fixes #731 Implements retry rule for flaky tests Adds a warning for IBM J9 VMs if mock generation fails Enable annotation engine as plugin Fixes bug were previously verified invocations could not capture arguâ€¦ Fixes #820 ReturnsArgAt to handle returning vararg as arrays Introduce validable answers for early validation of stubbing Test for verification listeners test can introduces bogus erro in other test cases. Improves exception message in case a matcher is used for a primitive parameter Fixes #838 : Adds a matches(Pattern) Fixes #860  jacaco synthetic fields are not anymore final in 0.7.8 Spy annotation reports better error message if instance creation is impossible CleansEmpty value returns empty arrays Fixes #814 : A elements were missing the name attribute, This PR aim to fix the issue described in #1621  the issue being that terminal type variable arguments were not looked up for their bounds.  Fixes #1621 This pull request will enable mocks to be serialized in a certain way  that will allow them to be serialized and especially deserialized outside the classloader the mock was created.  At the moment it s enabled automatically when using  withSettings().serializable() .  It still require to have Mockito on the classpath of the JVM classloader where it is deserialized. nan See issue #99   What it does is propagating the serializing mode of the parent  upon each mock creation when deep stubbing.  Before each mock created where made serializable by default. Which is not an issue when the types have a default no arg constructor  but may become problematic when the type didn t have one  Mockito would report an error explaining that it couldn t mock this type. Fixes issue #187  The value returned by the default answer is now validated to make sure there won t be a  ClassCastException  if the default value is incompatible with return type.  Reporter now fetch in safer way the mock name  in case the default answer is incorrectly implemented. This avoid a  ClassCastException  when reporting a verification issue. This should fix #233  (Awaiting delivery of bytebuddy fix https://github.com/raphw/byte-buddy/commit/6f223d93ee57b199abf0e7abaf4837df6d041f41)  Thanks @raphw In some recent version of mockito  @Spy  annotation will use the constructor rather than objenesis  that mean that constructor carry actual work. But since the interceptor set after instantiation  this raised an NPE with ByteBuddy. It wasn t an issue with CGLIB but it probably didn t event intercept such calls (unconfirmed at this point).  This PR aims to fix that by calling real code  if interceptor is not set  which can only happen if  ConstructorInstanciator  is used  Thanks to @raphw for his tip on this regard as well : https://github.com/raphw/byte-buddy/issues/32#issuecomment-113269844 Mock makers may have different capabilities. Historically CGLIB and Mockito were deeply related  later Mockmaker was created to allow Android developers to use dexmaker to create mocks. But logic that decided if a type could be mocked still reside in the mockito base  while it should be the responsibility of the mockmaker.  Also for example one could create his own mockmaker that forbid to mock type if some annotation is present. The motivation behind this rework  is that developers using JDK7+ see compiler warnings on some varargs methods.  While these warning are false alarms  users may not feel the same way. These compiler warnings cannot be entirely avoided   annotations like  @SafeVarargs  don t work on interfaces  and  @SuppressWarning({ unchecked    varargs })  have a limited impact on user code.  **As these annotations have limited impact  and most people use a single argument anyway  I propose to to introduce API that takes a single argument. While an overload can takes more arguments**  If we don t do that i.e. if we keep the same API with compiler warnings it may encourages users to add  @SuppressWarning({ unchecked    varargs })  in their test code  thus potentially hiding bugs in their code base. Test coverage reports have been broken with gradle without satisfying explanation  for quite some time. This pull request hopes to fix things Will fix #243 - null check on MockUtil.isMock() was incorrectly removed after successive refactoring  this PR reintroduces null check The  Reporter  friendly exception factory class lies in  org.mockito.exceptions.Reporter   however it s API is subject to change without really impacting user experience.  Thus  I propose to move  org.mockito.exceptions.Reporter  to  org.mockito.internal.exceptions.Reporter .  I didn t provided a dummy class for two reasons : 1. I would like to schedule this for Mockito 2 a major version 2. This class shouldn t be used outside framework development Renames  Matchers  to  ArgumentMatchers  to avoid name clash with Hamcrest  org.hamcrest.Matchers  class.  This plagued usage of mockito and hamcrest together since the introduction of matchers. The work in Mockito 2 beta allowed to avoid relying on hamcrest internally and thus split the Hamcrest matcher factory  MockitoHamcrest . Yet this is not enough as using both mockito matchers and hamcrest matchers in the same class  made the developer life not comfortable when using both API.  This change helps in that regard  as it renames the import class. Not this change tweaks only the class hierarchy  so current code still compiles  thanks to the javac compiler that can lookup static method in parent classes. (That is why I didn t updated tests yest  they could be upgraded in a late PR  a good timing would probably be when  Matchers  is removed)   Matchers  class can be removed in the next version of mockito  likely 3.0. Details is #194   I took the opportunity to  - replace  TestBase.assertThat  by more powerful AssertJ equivalent. There s still some work to be done in this class. - add iterable matchers  Before merging - [x] I ponder to make  anyObject()  not to accept  null   currently  any()  is an alias of  anyObject()  => Keeping the  anyObjet  behaviour and deprecate the method - [x] I need to update  anyInt  family description. Follow up on #510 (issue #194) following this comment https://github.com/mockito/mockito/pull/510#issuecomment-236877717  Basically it tweaks the collection matchers with generic support. It should have bee in abf9851. Changes NPE to IAE  see #554 #589 aimed to fix the javadoc rendering  but the assumption was that the javadoc tool of the Sun JDK6 will render javadoc the same way as openjdk6.  Unfortunately this is not the same  the javadoc rendering of openjdk6 is a pre work that avoid the use of table elements  this making the stylesheet incompatible.  This PR aims to fix that and thus fix #552   Bonus I changed the  2.*  and  2.0  by  2.0.0  in the javadoc  this way we have aligned version numbers The Java 8 helper interfaces have been introduced in #338. However the public  AdditionalAnswers.answer  family leak the functional interfaces.  These _parameter arity_ interfaces can be public  hence they are moved next to  Answer  in the  org.mockito.stubbing  package.  I m however in favor of adding the  @Incubating  annotation on those APIs and related objects. Thoughts ?  Fixes #614 Fixes #640 Warns user to upgrade if Java 8 version is to low.  Also took the opportunity to log other platform details if mock class cannot be created. Currently the code can print some arguments without necessary casts  see https://github.com/mockito/mockito/pull/571#issuecomment-241357864.  Before the exception message contained :       iMethods.forByte(0x19)      Which is actually not valid java. So the exception message now prints       iMethods.forByte((byte) 0x19)      This PR intends to fix it  this especially affects short and byte values. All in the title. This should fix #707 After using mockito  I have found that the new behaviors of matcher are good and indeed show problems in the test code or in the production code. However I have found that I miss an easy way to express a matcher for  nullable  argument when the production code may produce either  null  or value types  typically  Stream.of(<mixed values>).map(o -> mapper.map(c))...   the current options are :  *  <T> T any()  is nice but don t check the type. * there s always  AdditionalMatchers.or()  but this feel more heavy to use.  I m proposing the introduction of the argument matcher  <T> nullable(Class<T>)  which is a combination of  isA  and  isNull . I m not adding  <T> T nullable()  because this would have the same meaning as  <T> T any() Currently  addListener  and  removeListener  returns  void  which makes it repetitive to add or remove these :     java Mockito.framework().addListener(...)  Mockito.framework().addListener(...)  Mockito.framework().addListener(...)       The main change of this PR is to return  MockitoFramework  instead  thus allowing to chain invocations :     java Mockito.framework().addListener(...)                    .addListener(...)                    .addListener(...)       This improvements is a breaking change  however the API is still **incubating** and should be expected to break  source wise there s no problem since nothing could be done before due to the  void  return. This PR proposes to regroup all JUnit related classes in corrct packages. There s two changes :  * public : Deprecates  org.mockito.runners.MockitoJUnitRunner  and moves logic over  org.mockito.junit.runners.MockitoJUnitRunner     Questions :      * Should the runner be moved in the subpackage  junit.runner  or regroup the runner along with the rule in the  junit  package? (JUnit 5 will have neither of those)     * Should I do the same for already deprecated runners (console spamming and verbose runner)  * private : Moves JUnitHackerTool to  org.mockito.internal.junit.util Previous attempts at fixing the time related tests failed. Indeed the previous attempts are not bullet proof when the CI can run schedule some threads slower than _expected_.  A proper harness should be implemented  but in the meantime  I implemented the retry rule as proposed in #731 to gain back stability on the build. Related to #801  this PR simply adds a warning for IBM J9 VMs if the mock maker fails. Currently  AnnotationEngine  can be overrriden with the _deprecated_  MockitoConfiguration   in order to be more consistent with the new way  I propose to get the  AnnotationEngine  from the  PluginRegistry .  Regarding backward compatible behavior  if the  MockitoConfiguration  class exists and can be seen then Mockito will select the engine of this configuration instead of the  Plugins  one. If  MockitoConfiguration  class don t exist then Mockito wil chose the  Plugins  one.  Bonus I extended the classloader util to support some tests. Since Mockito 2 / #380 captured arguments is not anymore done for already verified interactions.     java IMethods mock = mock(IMethods.class)  mock.oneArg( first )  ArgumentCaptor<String> argument = ArgumentCaptor.forClass(String.class)  verify(mock  times(1)).oneArg(argument.capture())  assertThat(argument.getAllValues()).isEqualTo(1)   // additional interactions mock.oneArg( second )  argument = ArgumentCaptor.forClass(String.class)  verify(mock  times(2)).oneArg(argument.capture())  assertThat(argument.getAllValues()).isEqualTo(2)  // fail with mockito 2      The current behavior (Mockito 2.1 - 2.3.3) of  NumberedInvocationChecker  clears already verified interactions  before verifying the remaining interactions so the new argument captor is not populated with previous values. Which is akward if the times value is different that the lit size. Attempt at fixing #820  Basically it makes the ReturnsArgumentAt answer a bit more smart about varargs. But I m not satisfied with the fix yet. ## Overview  Custom Answers are now more robust - users can add add validation logic to the Answer implementation. It can validate the return type early  during stubbing in test  rather than fail late  during execution of code under test. Mockito team uses this API behind the hood for all custom implementations of Answer interface. Now advanced users can leverage this new API  too!     java class MyCustomAnswer implements Answer  ValidableAnswer { // <-- note extra  ValidableAnswer  interface   public Object answer(InvocationOnMock invocation) {     // answer implementation   }    public void validateFor(InvocationOnMock invocation) {     // throw MockitoException if answer cannot be applied to given invocation   } }        ## Implementation  While trying to fix #820 / #821  I noticed that  AnswersValidator  knew too much about other answers. To fix the design issue I propose the following design :  * Introduce  ValidableAnswer  in public API which is a single method interface that doesn t extends  Answer . * Each answer that wants to be validated hence implement this interface  Benefit  reduced visibility of some methods in these answers. Each new answer that want to be validated can just by implementing the new contract.  Validating returned value of a mock s default answer had to be handled differently. The following test (org.mockitousage.debugging.VerificationListenerCallBackTest#should_not_call_listener_when_verify_was_called_incorrectly) was causing non wanted exception in mockito      org.mockitousage.misuse.CleaningUpPotentialStubbingTest > shouldResetOngoingStubbingOnInOrder FAILED     org.mockito.exceptions.misusing.CannotStubVoidMethodWithReturnValue:       onVerification  is a *void method* and it *cannot* be stubbed with a *return value*!     Voids are usually stubbed with Throwables:         doThrow(exception).when(mock).someVoidMethod()      ***     If you re unsure why you re getting above error read on.     Due to the nature of the syntax above problem might occur because:     1. The method you are trying to stub is *overloaded*. Make sure you are calling the right overloaded version.     2. Somewhere in your test you are stubbing *final methods*. Sorry  Mockito does not verify/stub final methods.     3. A spy is stubbed using when(spy.foo()).then() syntax. It is safer to stub spies -         - with doReturn|Throw() family of methods. More in javadocs for Mockito.spy() method.     4. Mocking methods declared on non-public parent classes is not supported.         at org.mockito.internal.exceptions.Reporter.cannotStubVoidMethodWithAReturnValue(Reporter.java:448)         at org.mockito.internal.stubbing.answers.AnswersValidator.validateReturnValue(AnswersValidator.java:72)         at org.mockito.internal.stubbing.answers.AnswersValidator.validate(AnswersValidator.java:29)         at org.mockito.internal.stubbing.InvocationContainerImpl.addAnswer(InvocationContainerImpl.java:63)         at org.mockito.internal.stubbing.InvocationContainerImpl.addAnswer(InvocationContainerImpl.java:49)         at org.mockito.internal.stubbing.OngoingStubbingImpl.thenAnswer(OngoingStubbingImpl.java:28)         at org.mockito.internal.stubbing.BaseStubbing.thenReturn(BaseStubbing.java:16)         at org.mockitousage.misuse.CleaningUpPotentialStubbingTest.assertOngoingStubbingIsReset(CleaningUpPotentialStubbingTest.java:50)         at org.mockitousage.misuse.CleaningUpPotentialStubbingTest.shouldResetOngoingStubbingOnInOrder(CleaningUpPotentialStubbingTest.java:36) org.mockitousage.misuse.CleaningUpPotentialStubbingTest > shouldResetOngoingStubbingOnVerify FAILED     org.mockito.exceptions.misusing.CannotStubVoidMethodWithReturnValue:       onVerification  is a *void method* and it *cannot* be stubbed with a *return value*!     Voids are usually stubbed with Throwables:         doThrow(exception).when(mock).someVoidMethod()      ***     If you re unsure why you re getting above error read on.     Due to the nature of the syntax above problem might occur because:     1. The method you are trying to stub is *overloaded*. Make sure you are calling the right overloaded version.     2. Somewhere in your test you are stubbing *final methods*. Sorry  Mockito does not verify/stub final methods.     3. A spy is stubbed using when(spy.foo()).then() syntax. It is safer to stub spies -         - with doReturn|Throw() family of methods. More in javadocs for Mockito.spy() method.     4. Mocking methods declared on non-public parent classes is not supported.         at org.mockito.internal.exceptions.Reporter.cannotStubVoidMethodWithAReturnValue(Reporter.java:448)         at org.mockito.internal.stubbing.answers.AnswersValidator.validateReturnValue(AnswersValidator.java:72)         at org.mockito.internal.stubbing.answers.AnswersValidator.validate(AnswersValidator.java:29)         at org.mockito.internal.stubbing.InvocationContainerImpl.addAnswer(InvocationContainerImpl.java:63)         at org.mockito.internal.stubbing.InvocationContainerImpl.addAnswer(InvocationContainerImpl.java:49)         at org.mockito.internal.stubbing.OngoingStubbingImpl.thenAnswer(OngoingStubbingImpl.java:28)         at org.mockito.internal.stubbing.BaseStubbing.thenReturn(BaseStubbing.java:16)         at org.mockitousage.misuse.CleaningUpPotentialStubbingTest.assertOngoingStubbingIsReset(CleaningUpPotentialStubbingTest.java:50)         at org.mockitousage.misuse.CleaningUpPotentialStubbingTest.shouldResetOngoingStubbingOnVerify(CleaningUpPotentialStubbingTest.java:28)        The issue is that the mentionned test used a mock to create a listener for a test  but forgot to remove it. So on a next interaction with a mock  the listener was called  as such the last interaction is  void onVerification   so the answer could not be validated.  The case is easy to reproduce :     java interface Foo {     String nonVoid(String param)      void doSomething(String param)  } @Test public void should_not_call_listener_when_verify_was_called_incorrectly() {     //when     Foo foo = null      VerificationListener mockListener = mock(VerificationListener.class)      Mockito.framework().addListener(mockListener)      try {         verify(foo).nonVoid(  )          fail( Exception expected. )      } catch (NullInsteadOfMockException expected) {         //then         verify(mockListener  never()).onVerification(any(VerificationEvent.class))     }     // Mockito.framework().removeListener(mockListener)  // fix      // done in CleaningUpPotentialStubbingTest     try {         when(null).thenReturn( anything )  // throws instead CannotStubVoidMethodWithReturnValue         Assertions.fail( expected )      } catch (MissingMethodInvocationException e) {}  }      Given the conditions to reproduce the bug I d say we can keep the code that way. This should help for cases like #822   NPE can be raised by the JVM on the callsite of a matcher returning object like  any() . The thing is that the JVM does several thing like to allows a type to match a signature like  <T> T any()   type inference with Java 8  cast and unboxing. However  any()  can only return  null  so the JVM raises an NPE on the cast opcode. Of course the problem isn t new but more possible due to Java 8 flexibility. That s why Mockito had for a long time the primitive.  When mockito is used with the junit runner or the junit rule there s a  InvalidUseOfMatchersException  raised **after** the NPE with a message about misplaced matchers. This exception is raised because the matchers were not consumed by the mock since the NPE is raised first. So this exception is correct and can help the neophyte to discover the primitive variant like  anyInt() . Following discussion in #838 it is sensible to add a mockito matcher that can take a  Pattern  as an argument.  The usage is the same as  matches(String) .     java when(mock.oneArg(matches(Pattern.compile( [a-z]+\\d\\d )))).thenReturn(...)       Although it allows to build more complex regex  especially with regular expression flags. Fixes #860   This internal assumed JaCoCo fields will always be  static final   obviously not. JaCoCo 0.7.8 changed that. The simple fix was to make the source field _accessible_ instead of skipping this field.  Hence removing the test exclusion. This simple piece of code prevents the  SpyAnnotationEngine  to try create a spy instance for a some inner private class with different set of modifiers.  While preventing execution it reports slightly better error messages  before  some time the cause was  null  . This should fix #878 Fixes #876 and do a bit more cleanup  * Moves returning empty array from  ReturnsMoreEmtpyValues  to  ReturnsEmptyValues  * Cleans up javadoc * Removes reflection for Java8 types (implementation and tests)  Best to review commit by commit. Meaningful links probably never worked as expected.  The  A  elements were missing the  name  attribute  so the browser couldn t find the matching part of the document.  For reference : [5.9.8 Navigating to a fragment identifier](http://www.w3.org/html/wg/drafts/html/master/browsers.html#scroll-to-fragid)  > For HTML documents (and the text/html MIME type)  the following processing model must be followed to determine what the indicated part of the document is. >  > 1. Parse the URL  and let fragid be the <fragment> component of the URL. > 2. If fragid is the empty string  then the indicated part of the document is the top of the document. > 3. If there is an element in the DOM that has an ID exactly equal to fragid  then the first such element in tree order is the indicated part of the document  stop the algorithm here. > 4. If there is an a element in the DOM that has a name attribute whose value is exactly equal to fragid  then the first such element in tree order is the indicated part of the document  stop the algorithm here. > 5. Otherwise  there is no indicated part of the document.,
1,0,0,1,0,1,0,1,0,0,0,1,Ravi van Rooijen, 1567,1,0,0,0,0,0,0,1,0,0,0,1, Add warning to inline mock maker when running on a JRE, I made a topic about this in the [mailing list](https://groups.google.com/forum/#!topic/mockito/vKhx3R4_doQ).  Long story short: the inline mock maker doesn t work when running on just a JRE  so I added a warning in the error message if that s that case. This would ve saved me a lot of headache  so I figured I d maybe help a poor soul that encounters this in the future.,
1,0,0,1,0,0,0,1,0,0,0,1,Marcin MikoÅ‚ajczyk, 1895 1896,1,0,0,1,1,1,0,1,1,0,0,1, Fixes #1894 checkstyle error on windows Feature/returns empty java8 time, windows has some issues with relative paths in checkstyle config files  additionally it failed with an Euro sign in code.  please verify if it also works on unix env Im not sure why I see the commit [https://github.com/mockito/mockito/commit/428713153a9fc38e0e2547b255b40e62e9dc8479](url) that was already merged in changes  but: when creating this PR I had in mind that I would merge with branch 2.x (I didnt know back then that v2.x is maintenance only) hence the reflection-based methods (also to keep the coding style of the ReturnsEmptyValues class),
1,0,0,1,0,1,1,1,0,0,0,1,Tim Cooke, 1091,1,1,0,1,0,0,1,1,0,0,1,1, Fixes #1088 : Updating documentation of verify feature to correct a sâ€¦, Updating documentation of verify feature to correct a supposed typo that results in confusing behaviour when cut  pasted  and run verbatim.  The documentation presents the following example of the verify exact number of invocations feature:      //using mock     mockedList.add( once )           mockedList.add( twice )      mockedList.add( twice )           mockedList.add( three times )      mockedList.add( three times )      mockedList.add( three times )           //following two verifications work exactly the same - times(1) is used by default     verify(mockedList).add( once )      verify(mockedList  times(1)).add( once )           //exact number of invocations verification     verify(mockedList  times(2)).add( twice )      verify(mockedList  times(3)).add( three times )           //verification using never(). never() is an alias to times(0)     verify(mockedList  never()).add( never happened )           //verification using atLeast()/atMost()     verify(mockedList  atLeastOnce()).add( three times )      verify(mockedList  atLeast(2)).add( five times )      verify(mockedList  atMost(5)).add( three times )   The last but one line says:      verify(mockedList  atLeast(2)).add( five times )   This could be confusing to someone using these examples as it would result in a TooLittleActualInvocations failure being reported by Mockito. This is because in the example the  add()  method is never called with the String  five times . In order to have this example make sense in the way I think it should I ve replaced the String  five times  with  three times   as suggested by @szczepiq   Cheers  Tim Cooke,
1,0,0,1,0,0,0,1,0,0,0,1,Shyam Sundar J, 1893,1,1,0,1,0,0,1,1,0,0,1,1, Fixes #id : 1888, PR to fix the typo in the documentation,
1,0,0,0,0,1,0,1,0,0,0,1,David Genesis Geniza Cruz, 1714,1,1,0,1,0,0,1,1,0,0,1,1, Fixes #1713: fix typo in Mockito.java javadoc, I was confused and tried to look for  verifyNoMoreInvocations  when I came across this javadocs. Hopefully  this prevents further confusion.,
1,0,0,1,0,0,0,1,0,0,0,0,Robert Stupp, 1426,1,1,0,1,0,1,0,1,0,1,0,0, mockito on Java 11-ea+21, Fixes #1419   Requires  -Dnet.bytebuddy.experimental=true  system property to be set to let bytebuddy use asm API version  ASM7_EXPERMIENTAL  and use the same one in  InlineBytecodeGenerator .,
1,0,0,1,0,1,0,1,0,0,0,1,Pascal Schumacher, 382 441 442 446 452 455 456 458 459 460 464 467 468 469 479 498 501 502 503 504 512 513 514 515 516 519 523 572 573 574 578 579 587,1,1,0,1,1,1,1,1,1,0,1,1, correct package declaration of VerificationWithDescriptionTest delete ignored cglib related tests enable some ignored tests of BridgeMethodsHitAgainTest and DetectingFâ€¦ Make tests which test for timeouts with Thread#sleep more lenient. javadoc: improve grammar of some sentences activate VerificationWithTimeoutTest#shouldAllowTimeoutVerificationInâ€¦ fix some rawtype warnings remove dead code in ClassCacheVersusClassReloadingTest fix some rawtype warnings in tests delete disabled test for removed objenesis missing reporting feature fix some rawtype warnings in tests fix some rawtype warnings in tests add missing since javadoc tags for recently added methods and classesâ€¦ fix some rawtype warnings in tests fix grammar of sentence in Mockito javadoc remove unused imports refactored TestMethodsFinder to a static utility class (#426) refactored ArgumentsComparator to a static utility class (#426) refactored NonGreedyNumberOfInvocationsInOrderChecker to a static utiâ€¦ fixed some rawtype warnings fix some raw type warnings in tests replace TestBase#assertContainsIgnoringCase(String sub  String stringâ€¦ refactored MockUtil to a static utility class (#426) refactored AllInvocationsFinder and VerifiableInvocationsFinder to stâ€¦ replace TestBase#assertNotContains(String sub  String string) with Asâ€¦ replace TestBase#assertContains(String sub  String string) with Asserâ€¦ made some timeouts in VerificationAfterDelayTest and VerificationWithâ€¦ replace TestBase#assertContainsType(final Collection<?> list  final Câ€¦ replace TestBase#assertNotEquals with AssertJ #isNotEqualTo fix some rawtype warnings made some timeouts in VerificationAfterDelayTest and VerificationWithâ€¦ fix some rawtype warnings make VerificationWithTimeoutTest#shouldAllowMixingOnlyWithTimeout morâ€¦, allows project to compile without errors in eclipse  check list - [x] PR should be motivated  i.e. what does it fix  why  and if relevant how - [ ] If possible / relevant include an example in the description  that could help all readers      including project members to get a better picture of the change - [x] Avoid other runtime dependencies - [x] Meaningful commit history   intention is important please rebase your commit history so that each      commit is meaningful and help the people that will explore a change in 2 years - [x] Read the [contributing guide](https://github.com/mockito/mockito/blob/master/.github/CONTRIBUTING.md) - [ ] Mention  Fixes #<issue number>  in the description _if relevant_ - [ ] At least one commit should mention  Fixes #<issue number>  _if relevant_ nan â€¦inalMethodsTest  This worked locally  so let s see if this also works on the ci server.  Fixes #304 I took a look at the recently builds on travis ci and noticed a lot of failed builds. These failures where mostly unrelated to the actual changes  but caused by these strict timeout tests.  This pull request will not completely fix these random failures  but it should reduce their occurrences.   The ideal solution would be to completely remove usage of  Thread#sleep  from the test  but I have no idea how to do this. nan â€¦Order  This test work since https://github.com/mockito/mockito/pull/424 but was deactivated by mistake with https://github.com/mockito/mockito/pull/451 nan nan nan nan nan nan nan nan nan nan nan nan â€¦lity class (#426) nan nan â€¦) with AssertJ #containsIgnoringCase  Other methods of TestBase could be replaced in a similar way. nan â€¦atic utility classes (#426) â€¦sertJ #doesNotContain(CharSequence sequence) â€¦tJ #contains and #hasMessageContaining â€¦TimeoutTest more lenient to prevent frequent build failures on travis ci â€¦lass<?> clazz) with AssertJ assertion nan nan â€¦TimeoutTest more lenient to reduce build failures on travis ci nan â€¦e lenient to reduce build failures on travis ci  The two recent build failures where both caused by this test: https://travis-ci.org/mockito/mockito/jobs/154189781 https://travis-ci.org/mockito/mockito/jobs/154506554,
1,1,0,1,0,1,1,1,1,0,0,1,Christian Schwarz, 1221 144 373 404 427 431 432 451 476 486 490 535 540 547 550 590 591 635 704 775 776 777 778 779 907 908 914 933 1076 1162,1,1,0,1,1,1,1,1,1,0,1,1, MockitoExtension for JUnit5 enum Answers implements now Answer<Object> Fixes #365 Simplify the InvocationOnMock-API to get a casted argument Fixes #374 Removed deprecated classes and methods Refactored class Reporter to a static utillity Fixes #426 Dropped class HandyReturnValues Fixes #426 Refactored InvocationMarker to a static utility class Refactored Timeout and After concurrent test refactored ThreadSafeMockingProgress to a singleton Cleanup: removed dead/unnecessary classes Atleast to static refactored SuperTypesLastSorter to a static utility class inlined ArrayUtils.isEmpty() in ArgumentsProcessor refactored ObjectMethodsGuru to a static utility class Fixed #538 changed error message in case initialization for mock injection fails. removed package org.mockito.internal.listeners refactored ArgumentMatchingTool to a static utillity class Unified logic of argument matching and capturing DelayedExecution uses now a more precise approach to call a mock async. Removed private isMockitoMock(..) in MockUtil InvocationMatcher internal improvements Replaced ObjectBox with AtomicReference ValuePrinter small improvements Removed argument from MockingProgress.stubbingCompleted(..) Unified all number of invocations checker in NumberOfInvocationsChecker Simplified the creation of ArgumentsAreDifferent-Exceptions. Refactored RemoveFirstLine to a static utility class. Support for return type  Void  in DoesNothingAnswer Fixed validation in returnArgumentAt(int) in case of type erasure on the parameter Fix for #1155 thenThrow(Class), Fixes #445  Discussion: https://groups.google.com/forum/#!topic/mockito/R1L1aG2RgBQ  First of all  thanks to the JUnit5-Team (@sbrannen) for that great API! The implementation was straight forward and the docu is top notch. Not comparable to a JUnitRule or Runner implementation. One can feel the hard work.   ----  The here provided  MockitoExtension  allows to mock/spy/validate like the well known Mockito-JUnitRule/Runner. This is still  work in progress   feel free to comment.  Usage:     Java @ExtendWith(MockitoExtension.class) class JUnit5Test {     @Mock   private Dependency mock      @Test   void checkMockCreation(){     when(mock.foo()).thenReturn( Hello JUnit5 )      mock.foo()      verify(mock).foo()    } } The enum type Answers implements now the Answer interface. This allows us to use the enum values in  Mockito.mock(Class Answer) . This is handy when you have to test legacy code with PowerMockito and want to use both  @Mock  and  Mockito.mock(..) .      java @Mock(answers=RETURNS_DEEP_STUBS)  ClassA a  ClassB b   public void setUp(){   b= mock(ClassB Mockito.RETURNS_DEEP_STUBS)   //<< static import is not possible here  but with this pull request we can use RETURNS_DEEP_STUBS we used in @Mock. } This pull request fixes #365 by introducing  T getArgument(int)  and deprecating  T getArgumentAt(int Class<T>)  in type  InvocationOnMock . This improves the readabilty of custom Answers.   This...  String text = invocation.getArgumentAt(1 String.class)   can be replaced by...   String text = invocation.getArgument(1) Fixes #374 removed deprecated classes and methods Fixes #426 for class Reporter   This PR changes the way errors are created and thrown. All methods of the Reporter are now static so they can be imported statically and return an exception instead of throwing it directly. This improves the readability and eliminates the use of hacks to satisfiy the compiler.  Here is a sample:      public List<T> getLastVarargs() {         if (arguments.isEmpty()) {             Reporter().noArgumentValueWasCaptured()              return null          } else {             return arguments.getLast()          } }      The above code snipped can be rewritten to this:      public List<T> getLastVarargs() {         if (arguments.isEmpty()) {             throw noArgumentValueWasCaptured()          }          return arguments.getLast()  } #426  While refactoring the class HandyReturnValues  towards a static utility class I notices that it is not required at all. Therefore I decided to remove the type  HandyReturnValues . #426  Refactored  InvocationMarker to a static utility class Refactored concurrent test in order to fix #433. The implementation now uses  an  Executor to perform async calls instead of extending  Thread  and doesn t extend TestBase anymore.   I also added a Stopwatch which can be used for further time dependent testing. In the future I want to use this class to write more tests for After/Timeout. The actual implementation of [ThreadSafeMockingProgress](https://github.com/mockito/mockito/blob/master/src/main/java/org/mockito/internal/progress/ThreadSafeMockingProgress.java) disguise that it is effectively a singleton cause the ThreadLocal member is static. This makes it hard to see that different instances  share the same state.  This PR... - refactores  ThreadSafeMockingProgress to provider of MockingProgress instances - uses the standard way of instantiating the initial  ThreadLocal value this also avoids possible race conditions Removed dead/unnecessary classes: - VarargCapturingMatcher and Test - AnyVararg removed in Favor of Any  Any can now used as varargs matcher too       removed test [shouldNotAllowAnyObjectMatchEntireVararg()](https://github.com/mockito/mockito/blob/master/src/test/java/org/mockito/internal/invocation/ArgumentsComparatorTest.java#L110) cause it was not clear why ANY should not be allowed as varargs matcher - Unified  AtLeastXNumberOfInvocationsChecker  and    AtLeastXNumberOfInvocationsInOrderChecker  into a static utility class - Unified  MissingInvocationChecker  and  MissingInvocationInOrderChecker  in   a static utility class refactored SuperTypesLastSorter to a static utility class  relates to #426 Inlined ArrayUtils.isEmpty() in ArgumentsProcessor and removed ArrayUtils cause it was only used in ArgumentProcessor. Also isEmpty(..) was renamed to isNullOrEmpty(..) for clarity.  relates to #426 - refactored  ObjectMethodsGuru  to a static utility class - removed unused methods and associated tests:   -  isToString(MockitoMethod method)    -  isEqualsMethod(Method method)    -  isHashCodeMethod(Method method)  - renamed  isToString(..)  to  isToStringMethod(..)   relates to #426 Fixed #538  If a filed is annotated with @InjectMocks and the type of a field is an enum  inner class  interface or local class the error message is now: _ Mock injection failed on field  fieldName  cause the type  AbstractCollection  is an abstract class._ - deleted unused and empty interface  MockingProgressListener  - moved  NotifiedMethodInvocationReport  to  org.mockito.internal.handler relates to #426 The logic of argument matching and capturing is the same but can be found in ArgumentsComparator and InvocationMatcher. This PR unifies the decision logic how matchers are applied to argument+varargs by introducing a  MatcherApplicationStrategy . This strategy can apply an action to an pair of ArgumentMatcher and Argument. One action is used to perform the ArgumentMatcher.matches(arg) call and an other is used to perfrom the capturing. - fixes #439 ArgumentCaptor and ArgumentMatcher s can now be mixed in varargs - fixes #583 No more NPE when null is passed to an varargs  - added 25 regression tests in VarargsTest (5 are ignored cause they belong to other issues and fail currently)  - reduced logic duplication New approach to fix flickering async tests.  Detail description  coming soon... Small internal refactoring. InvocationMatcher internal improvements  * Added missing @Override annotations to reduce warning count.  * Simplified parameter comparison in hasSameMethod(..)  * Fixed compile error due to char conversion in MatchersTest Removed ObjectBox in favor of AtomicReference. * added private construtor  * removed unneccessary  else  statements  * added missing type arguments  * replaced  new ArrayIterator(new String[]{  })  with  emptyIterator()  in _printValues(..)_ Removed unneccessary argument from internal MockingProgress.stubbingCompleted(..) fixes #426  This PR unifies the functionality of  NonGreedyNumberOfInvocationsChecker    NumberOfInvocationsCheckerInOrder  and  NumberOfInvocationsChecker  in static methods of the type  NumberOfInvocationsChecker .   This saves ~50 lines of code and increases readability on the call sides. relates to #426   This PR simplifies the creation of ArgumentsAreDifferent-Exceptions. Saving 2 classes and ~40 lines of code. Relates to #426   Refactored  RemoveFirstLine  to a static utility class.  I would like to unifiy  RemoveFirstLine    Decamelizer  and  StringJoiner  to a new type  StringUtil . They all manipulate strings and contain only a few methods that are not worth to live in a dedicated classes  any thoughts? fixes #927  This PR allows to use  doNothing(..)  for methods with return type  java.lang.Void  like void-methods.    To solve this  InvocationInfo.isVoid()  checks now the return type for the pseudo-type of the keyword  void  or  Void . Fixes #1071   The parameter type inference takes now the type of the actual instance into account to avoid type erasure issues in case the parameter is generic.  see also: https://github.com/mockito/mockito/issues/1071#issuecomment-300091021 Fix for #1155  Mockito.thenThrow(Class) now fails when the given Throwable type is not declared on the stubbed method.,
1,1,0,1,0,0,1,1,0,0,0,1,Evgeny Astafyev, 317,1,0,0,1,0,1,1,1,1,0,0,0, Modify StackTraceFilter to not exclude  good  stack trace elements, currently StackTraceFilter filters in this way (example from javadoc): [a+  b+  c-  d+  e+  f-  g+] -> [a+  b+  g+]  this patch makes it work: [a+  b+  c-  d+  e+  f-  g+] -> [a+  b+  d+  e+  g+]  Not sure why it was implemented first time in this strange manner.  ---  **EDIT by Mockito team** : Fixes #316,
1,0,0,0,0,0,0,1,0,0,0,1,Frank Pavageau, 1718,1,1,0,1,0,1,0,1,0,1,0,1, Fixes #1717 : configure the MethodVisitor for Java 11 compatibility, I m looking into adding a unit test  if I can find how to use Byte Buddy to generate a class with a Conditional Dynamic instruction when running with Java 11.,
1,0,0,1,0,0,0,1,0,0,0,1,Piotrek Å»ygieÅ‚o, 2158,0,0,0,1,0,1,0,0,1,0,0,0, Add field type in @Mock example, javadoc-only change <sup>(IMO not worth separate issue nor RN mentioning.)</sup>,
1,0,0,1,0,0,0,1,0,0,0,1,David Xia, 532,1,1,0,1,0,0,1,1,0,0,1,1, Fix typo in Javadocs, - [x] PR should be motivated  i.e. what does it fix  why  and if relevant how - [x] If possible / relevant include an example in the description  that could help all readers      including project members to get a better picture of the change - [x] Avoid other runtime dependencies - [x] Meaningful commit history   intention is important please rebase your commit history so that each      commit is meaningful and help the people that will explore a change in 2 years - [x] Read the [contributing guide](https://github.com/mockito/mockito/blob/master/.github/CONTRIBUTING.md) - [x] Mention  Fixes #<issue number>  in the description _if relevant_ - [x] At least one commit should mention  Fixes #<issue number>  _if relevant_  Also improve sentence structure of surrounding sentences.,
1,0,0,0,0,1,0,1,0,0,0,0,Shaun Abram, 309,1,1,0,1,0,0,1,1,0,0,1,1, Tweaks to the main Mockito javadocs to aid readability, @szczepiq as discussed  please review.,
1,0,0,1,0,1,1,1,0,0,0,1,TDurak, 1387,1,0,0,1,0,0,0,0,0,0,0,1, Fixes #1386: Adding atMostOnce()  rename ThreadVerifiesContinuoslyInteractingMockTest and one TODO, Hi   I would like to make a quick contribution on this project.  I add atMostOnce()  it seem s not to be a big feature. I just want to highlight the fact you have the function atLeastOnce() but nothing for the atMostOnce case.  I rename the testClass ThreadVerifiesContinuoslyInteractingMockTest on ThreadVerifiesContinuouslyInteractingMockTest and the TODO on toString() from HamcrestArgumentMatcher.,
1,0,0,1,0,0,0,1,0,0,0,1,Jeffrey Falgout, 549 615,1,1,1,1,0,1,0,1,1,0,0,1, Fully register a class ancestry for GenericMetadataSupport Fixes #497 : RETURNS_DEEP_STUBS may try to mock final classes, The old implemention would take a class X and consider all of its superclasses and the interfaces implemented by X and the interfaces implemented by all of its superclasses.  The new implementation also considers the superinterfaces of the interfaces implemented by X and the superinterfaces of the interfaces implemented by its superclasses.  Fixes #497 Fixes #497  With deep stubs  it was possible for generic metadata to be lost/unused through nested invocations on non generic types. This could cause  RETURNS_DEEP_STUBS  to try mocking final classes which would result in a  ClassCastException .  Apparently my other PR (#549) wasn t quite enough to fully fix this problem.  ---  **EDITED by mockito team**,
1,0,0,0,0,1,0,1,0,0,0,1,Przemyslaw Bielicki, 142,1,0,0,0,0,1,0,1,1,0,0,0, Fix #128 : Deep stubbing with generic responses in the call chain is not working, nan,
1,1,0,1,0,1,1,1,1,0,1,1,Allon Murienik, 1231 880 881 923 926 928 935 959 980 1009 1022 1023 1025 1040 1096 1118 1137 1199 1201 1209 1213,1,1,1,1,1,1,1,1,1,1,1,1, InvocationsPrinter string concatination Fixes #879: ArgumentMatchers javadoc grammar improvement Fixed #879: ArgumentMatchers grammar fix SmartPrinterTest toStirng() calls Remove string concatination inside an append call Fix whitespace issues throughout the code New feature - enable mocking using constructor arguments Fix broken build Fixes #976: Resolve ambiguous constructors Clean up unused imports MatchersTest numeric literals Fix broken link in Mockito javadoc SmartPrinterTest toString() calls Fix javadoc issues InOrderImpl constructor signature ArgsMismatchFinder#getStubbingArgMismatches generics Don t use raw rypes in UnusedStubbingsTest Fixes 977: Javadoc on verifyZeroInteractions Fix javadoc in PluginLoader#withAlias  javadoc Clean up JUnit imports Standardize JUnit imports, Replace string concatination inside an append call with a chained  append  calls to make the code a tad easier to read  so the reader isn t left wondering why some of the concatinations are done with  append s and some with the  +  operator. Fixed grammar issue in  ArgumentMatchers :  > This implementation is due static type safety imposed by java compiler.  Should be:  > This implementation is due to static type safety imposed by java compiler.  This PR fixes issue #879. Cherry-pick PR #880 to the 2.x branch  This PR should fix issue #879 on this branch too. Calling  toStirng()  on a string just returns the same instance  making this call quite useless. This patch removes those calls in order to clean up the code a bit. Concatinating Strings creates a temporary StringBuilder  which is then converted to a String. Having such an argument inside a StringBuilder#append call thus pointless. Using a chained append call will have the exact same outcome  and would profit a slight [probably unnoticeable in this instance] performance benefit. This patch applies de-facto standards the codebsae currently has regarding whitespaces on all the java files in the project:  - Newlines were added at the end of files that didn t have them. - Whitespaces at the end of source lines were removed.  All these changes were done by running  sed  on the codebase. The exact details can be found in the individual commit messages. ## Motivation and design - see #685  To quote the requirement (see in-depth design in #685): > We already support spying on abstract classes by allowing parameterless constructor. However  there is no support for constructor parameters. This has been asked about long time ago. Mockito API is not robust enough if it supports mocking with constructor but not when one has any constructor parameters.  This patch enhances the  MockSettings#useConstrctor()  method (as suggested in the alternative API comment in the issue) and adds optional ellipsis arguments that are passed to the constructor.  The patch streamlines the creation of mocks via constructors to a single flow  where using a no-arg constructor or an enclosing class are just private cases of this flow  and don t require their own special treatment. Commit da4e42 introduced a static import from the non-existent  org.mockito.internal.util.StringJoiner  (it exists only in the master branch  not the release/2.x branch). This patch fixes the build by correcting the import to reference  org.mockito.internal.util.StringUtil . With the current code (introduced in Mockito 2.7.14 by commit 6a82c03)  calling  MockSettings.useConstructor  with an argument list that would be applicable to more than one constructor would fail with an  org.mockito.internal.creation.instance.InstantiationException .  This behavior  however  is suboptimal  as described in issue #976  as it makes  useConstructor  less robust than the Java compiler  which is able to resolve such ambiguities. With this patch  Mockito will attempt to match the constructor with the most specific parameter types. A constructor X is considered more specific than a constructor Y if:  1. They are both applicable to the given argument list 2. Constructor X has at least one parameter which is a further specialization of the corresponding parameter of constructor Y (i.e.  paramX.isAssignableFrom(paramY) ). 3. Constructor Y has no parameter which is a further specialization of the corresponding parameter of constructor X  as defined above.  E.g.  consider the following class:      public class SomeClass {         SomeClass(Object o) {}         SomeClass(String s) {}     }  Without this patch  calling      mock(SomeClass.class  withSettings().useConstructor( string! ))  would fail. With this patch  such a call would invoke the  SomeClass(String)  constructor.   As noted above  this PR fixes issue #976. During development work  orphaned  unused  imports sometime get left behind in the code. At best  these imports are just redundant. At worst  they introduce false dependencies in places there aren t supposed to be any dependencies.  This patch removes all those unused imports and adds a Checkstyle module to verify no such redundant imports will be introduced in the future. Use numeric literals  which are more elegant  instead of casting int literals to other primitive types. Commit  6a82c030756a30932406d6b807e7ca34f20631e3 (included in Mockito 2.7.14) changed  MockSetting#useConstructor  s signature to accept an  Object...  argument. While this change is backwards compatible (as calls can continue passing an empty argument list)  it broke the javadoc reference to  useConstructor()  in Mockito s javadoc. Calling  toString()  on a String object just returns the same object  making such calls useless in most cases.  This patch removes such calls from  SmartPrinterTest   making the code a cleaner and easier to read. This PR fixes several javadoc issues reported by IntelliJ IDEA. Two types of errors are not handled in this PR:  - References which gradle is unable to resolve - these references seem to be valid javadoc links  so there s either an issue with gradle itself of with the configuration this project is using  and needs a deeper look - Javadoc tags missing descriptions  which require a deeper understanding of the methods in question in order to resolve. Replace  List<? extends Object>  in the constructor s argument list with a simpler  List<?> . The  extends Object  adds nothing  and just serves to confuse the reader. This patch allows calling  getStubbingArgMismatches  with any  Iterable   not just an  Iterable<Object>  in order to make it more convenient to use.  As seen in  ArgMismatchFinderTest   this saves having to cast potential arguments to raw types. Use generic specification instead of casting to the raw List type in order to make it a bit stricter.  Note that when we move to Java 8 language level these workarounds could be completely removed as the built in type inference should handle it. Make the javadoc of  Mockito#verifyZeroInteractions  to make it more obvious that it does the same thing as  Mockito#verifyNoMoreInteractions .  Fixes #977 Fix the misuse of  @Deprecated  in  PluginLoader#withAlias  -  @Deprecated  is an annotation  while the correct javadoc tag is  @deprecated . Fix JUnit imports throughout the project to use the standard  org.junit.Assert  assertions instead of the obsolete  junit.framework.TestCase  assertions which just delegate to  Assert  s methods. This PR standardizes importing assertion methods  making the code base cleaner and easier to maintian.,
1,0,0,0,0,1,0,1,0,0,0,1,Allan Wang, 1484,1,0,0,0,0,0,0,1,0,0,0,0, Fix some typos, don t -> doesn t,
1,0,0,1,0,1,0,1,0,0,0,1,Hugh Hamill, 87,0,0,0,0,0,1,0,1,0,0,0,0, Fixed DelegatingMethod.equals() so that it s easier to extend Mockito by custom verification modes, Currently if you create a DelegatingMethod and compare it to itself using .equals() it will show as not equal because the .equals() method expects a java.lang.reflect.Method (without explicitly stating such).  This has a knock on effect on the evaluation of InvocationImpl.equals() which at runtime may be using a DelegatingMethod in its .equals().  I have changed .equals() and .hashCode() in DelegatingMethod to a more appropriate implementation  which can handle both the case where the input object is a DelegatingMethod and where it is a java.lang.reflect.Method.  I ran up against this issue when creating a custom VerificationMode which used InvocationImpl.equals() to check that the appropriate invocation was made.  My comparison failed even though I was comparing two references to the same InvocationImpl instance.,
1,1,0,1,0,1,0,1,0,0,0,1,Tim Perry, 14 15,1,0,0,1,0,1,0,1,0,0,1,1, Deprecated timeout().never()  in line with timeout().atMost() Verification with timout measures time more more accurately, Timeout().atMost() is deprecated due to issue 235: https://code.google.com/p/mockito/issues/detail?id=235  These exact same arguments apply to never()  both verification modes are extremely likely to create assertions that immediately pass  and do not test what they re intended to test. This patch therefore deprecates never() similarly.  Fairly shortly I m also planning on implementing verify(mock  during(x).[...])  as a counterpart to timeout which always waits the full time  as discussed in issue 347: https://code.google.com/p/mockito/issues/detail?id=347. This should allow for the kind of assertion behaviour that timeout().never() implies.  (Also some minor whitespace tidy up and spelling corrections) The previous timeout implementation doesn t measure time correctly: it only counts time spent intentionally sleeping  thus losing time on anything that happens when not sleeping (both the actual verification time  and time spent in other threads during verification)  and gaining time if any InterruptedExceptions occur.  Typically this means that timeout()s actually run for a longer than they re intended to. The fixed test demonstrates this well  previous the timeout was set to exactly the minimum possible time the sleeps in the code alone could ve taken  ignoring all processing time  and this test consistently passed. After the changes it now fails (as it probably should).  This patch fixes that by just measuring the time directly. I ve also fixed some variables names that were slightly annoying  and that now-failing test has a 500ms buffer before it times out.,
1,0,0,0,0,1,0,1,0,0,0,0,Artem Prigoda, 1953,1,1,1,1,1,1,1,1,1,1,1,1, Fix a confusing typo in subclassing error message, nan,
1,0,0,0,0,0,0,1,0,0,0,0,Kayvan Najafzadeh, 1407,1,1,0,1,0,0,1,1,0,0,1,1, removing redundent sentence, There was a redundant sentence in the documentation (it was repeated 2 lines below it).,
1,0,0,0,0,0,0,1,0,0,0,1,Alberto Scotto, 419,0,0,0,0,0,0,0,0,0,0,0,0, BDDMockito: rename willNothing to willDoNothing, .. and keep the original signature as deprecated,
1,0,0,0,0,1,0,1,0,0,0,0,Kamil SzymaÅ„ski, 36 37,1,1,0,1,0,1,0,1,0,0,0,1, Refactoring: inner implementations of Filter and Comparator should be static Refactoring: avoid static keyword in inner interface definition, nan inner interfaces are implicitly static,
1,0,0,1,0,1,0,1,0,0,0,1,Lukasz Szewc, 207 211 294 600 619,1,1,0,1,0,1,1,1,1,0,1,1, Fixes #197 : Blocks ability to use negative value for timeout() and after() method. ArgumentCaptor no longer working for varargs Removed deprecated ReturnValues and all it s occurrences suppressed compiler warning and unchecked collections cast Fixes #548 from now on verification happens always call in other threâ€¦, It should fix issue #197.   If user uses Mockito.after() or Mockito.timeout() with negative values  then friendly reminder exception with details will be thrown. Fixes #188 . These commits should fix issue with capturing varargs. These changes should  deal with  issue #273 - suppressed compile time warning - refactor raw collection cast Should fix problems with #548 and #601,
1,0,0,1,0,0,0,1,0,0,1,0,Max Zhu, 1809,1,1,0,1,0,0,1,1,0,0,1,1, update javadoc.io link from /page/ to /doc/  which gives an extra navâ€¦, â€¦ bar on the top so that users can easily navigate to old versions  > Hey   >  > Thanks for the contribution  this is awesome. > As you may have read  project members have somehow an opinionated view on what and how should be > Mockito  e.g. we don t want mockito to be a feature bloat. > There may be a thorough review  with feedback -> code change loop. >  > Which branch :  > - On mockito 3.x  make your pull request target  release/3.x  > - On mockito 2.x  make your pull request target  release/2.x  (2.x is in maintenance mode) > > _This block can be removed_ > _Something wrong in the template fix it here  .github/PULL_REQUEST_TEMPLATE.md    check list   - [x] Read the [contributing guide](https://github.com/mockito/mockito/blob/release/3.x/.github/CONTRIBUTING.md)  - [x] PR should be motivated  i.e. what does it fix  why  and if relevant how  - [x] If possible / relevant include an example in the description  that could help all readers        including project members to get a better picture of the change  - [x] Avoid other runtime dependencies  - [x] Meaningful commit history   intention is important please rebase your commit history so that each        commit is meaningful and help the people that will explore a change in 2 years  - [x] The pull request follows coding style  - [x] Mention  Fixes #<issue number>  in the description _if relevant_  - [x] At least one commit should mention  Fixes #<issue number>  _if relevant_,
1,0,0,1,0,1,1,1,0,0,1,1,Kengo TODA, 1404,1,1,0,1,0,0,1,1,0,0,1,1, Fix wrong artifact name in javadoc  and link to proper javadoc page, ## motivation  1. Current javadoc in  Mockito.java  uses wrong artifact name  org.mockito.junit-jupiter   but it should be [org.mockito:mockito-junit-jupiter](https://mvnrepository.com/artifact/org.mockito/mockito-junit-jupiter). To avoid user s confusion  fix it with correct name. 2. The  MockitoExtension  isn t contained in  mockito-core   so we cannot use hyper link generated by  {@link ...} . Instead  we can use  <a>  tag to guide users to proper javadoc page.  ## check list   - [x] Read the [contributing guide](https://github.com/mockito/mockito/blob/release/2.x/.github/CONTRIBUTING.md)  - [x] PR should be motivated  i.e. what does it fix  why  and if relevant how  - [x] If possible / relevant include an example in the description  that could help all readers        including project members to get a better picture of the change  - [x] Avoid other runtime dependencies  - [x] Meaningful commit history   intention is important please rebase your commit history so that each        commit is meaningful and help the people that will explore a change in 2 years  - [x] The pull request follows coding style  - [x] Mention  Fixes #<issue number>  in the description _if relevant_  - [x] At least one commit should mention  Fixes #<issue number>  _if relevant_  Thanks for your great product that really helps our daily hacking :),
1,0,0,1,0,0,0,1,0,0,0,1,IsmaÃ«l MejÃ­a, 2279,0,1,0,0,0,0,0,0,0,0,0,0, Remove ASM dependency, Mockito depends on byte-buddy to make most of its bytecode fiddling but ASM is still needed for the tests. We can remove this dependency by relying on the already shaded version included on ASM  that we we won t get unaligned between both dependencies and we will remove the need for the explicit ASM library.  R: @raphw  <!-- Hey   Thanks for the contribution  this is awesome. As you may have read  project members have somehow an opinionated view on what and how should be Mockito  e.g. we don t want mockito to be a feature bloat. There may be a thorough review  with feedback -> code change loop. --> <!-- Which branch :  - On mockito 3.x  make your pull request target  release/3.x  - On mockito 2.x  make your pull request target  release/2.x  (2.x is in maintenance mode) --> <!-- If you have a suggestion for this template you can fix it in the .github/PULL_REQUEST_TEMPLATE.md file --> ## Checklist   - [ ] Read the [contributing guide](https://github.com/mockito/mockito/blob/release/3.x/.github/CONTRIBUTING.md)  - [x] PR should be motivated  i.e. what does it fix  why  and if relevant how  - [ ] If possible / relevant include an example in the description  that could help all readers        including project members to get a better picture of the change  - [x] Avoid other runtime dependencies  - [ ] Meaningful commit history   intention is important please rebase your commit history so that each        commit is meaningful and help the people that will explore a change in 2 years  - [x] The pull request follows coding style  - [ ] Mention  Fixes #<issue number>  in the description _if relevant_  - [ ] At least one commit should mention  Fixes #<issue number>  _if relevant_,
1,0,0,0,0,0,0,1,0,0,0,1,PaweÅ‚ PamuÅ‚a, 1639,1,1,0,1,0,0,1,1,0,0,1,1, Removes inaccessible links from javadocs in Mockito.java, The monkeyisland.pl domain is no longer available.  List of inaccessible articles: http://monkeyisland.pl/2009/01/13/subclass-and-override-vs-partial-mocking-vs-refactoring http://monkeyisland.pl/2008/07/12/should-i-worry-about-the-unexpected http://monkeyisland.pl/2008/04/26/asking-and-telling http://monkeyisland.pl/2009/01/13/subclass-and-override-vs-partial-mocking-vs-refactoring,
1,0,0,1,0,1,0,1,0,0,0,1,Jakob JÃ³nasson, 831,1,0,0,1,0,1,0,1,0,0,1,1, Test clean up according to discussions for RememberingListeners, According to issue @719 we wanted to clean up the tests for RememberingListeners.  The tests should follow the same style and conventions. Set up should not contain variables used by all the tests.  We previously had another PR for this in #825. That build was failing for some reason not obvious and had 1 merge commit that we wanted to remove. In an attempt to rebase and reset the history github lost the connection to the remote fork. Instead of spending time investigating I just created a new PR.,
1,0,0,1,0,0,0,1,0,0,0,0,Ahmad M, 1994,1,0,0,1,0,1,0,1,0,0,0,1, Fix typo in CONTRIBUTING.md and SpyOnInjectedFieldsHandler, Fix typo in CONTRIBUTING.md and SpyOnInjectedFieldsHandler.java,
1,0,0,1,0,0,0,1,0,0,1,0,Dr. Thomas Tautenhahn, 1795,1,0,0,1,0,1,1,1,1,0,0,1, Typos and upcoming warnings, Fixed some typos which where found by a spell checker.  check list   - [ ] Read the [contributing guide](https://github.com/mockito/mockito/blob/release/3.x/.github/CONTRIBUTING.md)  - [ ] PR should be motivated  i.e. what does it fix  why  and if relevant how  - [ ] If possible / relevant include an example in the description  that could help all readers        including project members to get a better picture of the change  - [ ] Avoid other runtime dependencies  - [ ] Meaningful commit history   intention is important please rebase your commit history so that each        commit is meaningful and help the people that will explore a change in 2 years  - [X] The pull request follows coding style  - [ ] Mention  Fixes #<issue number>  in the description _if relevant_  - [ ] At least one commit should mention  Fixes #<issue number>  _if relevant_,
1,0,0,1,0,0,0,1,0,0,0,1,Jesse Englert, 972,0,0,0,0,0,0,0,0,0,0,0,0, Verifies #688: Acceptance test to prevent future regression, Added an acceptance test to verify #688,
1,0,0,1,0,1,1,1,0,0,0,1,Bastien Jansen, 1521,1,1,0,1,0,0,1,1,0,0,1,1, Minor improvements in the Javadoc of Mockito.java, This PR fixes a type and adds a reference to the JUnit5 extension.  check list   - [x] Read the [contributing guide](https://github.com/mockito/mockito/blob/release/2.x/.github/CONTRIBUTING.md)  - [x] PR should be motivated  i.e. what does it fix  why  and if relevant how  - [ ] If possible / relevant include an example in the description  that could help all readers        including project members to get a better picture of the change  - [x] Avoid other runtime dependencies  - [x] Meaningful commit history   intention is important please rebase your commit history so that each        commit is meaningful and help the people that will explore a change in 2 years  - [x] The pull request follows coding style  - [ ] Mention  Fixes #<issue number>  in the description _if relevant_  - [ ] At least one commit should mention  Fixes #<issue number>  _if relevant_,
0,0,0,1,0,0,0,0,0,0,0,0,Niklas Baudy, 1280,0,0,0,1,0,0,0,1,0,0,0,0, Update STRICT_STUBS documentation for verifyNoMoreInteractions, Fixes #1086,
1,0,0,1,0,0,0,1,0,0,0,1,GÃ¡bor LiptÃ¡k, 2135,1,0,0,1,0,0,0,0,0,0,0,1, Add void static method mocking example, Signed-off-by: GÃ¡bor LiptÃ¡k <gliptak@gmail.com>  https://github.com/mockito/mockito/issues/2027,
1,0,0,1,0,0,0,1,0,0,0,1,GaÃ«tan Muller, 705,0,0,0,1,0,1,0,1,0,0,0,0, Fixes exception typo, This is a simple correction in an error message that can be thrown by Mockito.,
1,0,0,1,0,0,0,1,0,0,0,1,Michal Kordas, 221 222 314,1,0,0,1,0,0,0,1,0,0,0,0, Fixes #212 : Add shouldHaveZeroInteractions as BDD version of verifyZeroInteractions Fixes #203 : Introduce BDD InOrder verification Add shouldHaveNoMoreInteractions() to BDDMockito, Follow-up to #212 Follow-up to #203. Replicates  verifyNoMoreInteractions  on the BDD API.  ---  **EDIT by mockito team** : Fixes #311,
1,0,0,1,0,1,0,1,0,0,0,1,Max Grabenhorst, 1544,1,0,0,0,0,0,1,1,0,0,0,0, Fixes #1541: Prevent premature garbage collection of mock objects, Fixes #1541.  If using  One-liner stubs  (https://static.javadoc.io/org.mockito/mockito-core/2.23.4/org/mockito/Mockito.html#one_liner_stub) the mock object may be premature cleaned up and returning the mock fails with an exception. This occurs because there is no strong reference to the mock itself.  Therefore we need to maintain a strong reference to the mock until we ve returned it  while making sure that the GC can still cleanup the mock correctly when needed.  Cause implementations of  BaseStubbing  are intended to be cleaned up after usage  we can store a strong ref to the mock there.  getMock  then uses the strong ref (instead of the weak ref provided by the invocation). After cleaning up the implementations of   BaseStubbing  there is no strong ref to the mock itself anymore (except the one in the test class).  I tried some alternative solutions but I believe this is the only way it works.  ----  Bind last mock creation to mockingProgress does not work because of this:     when(mock(TestClass2.class).getTestClass()).thenReturn(mock(TestClass.class)).getMock()       Bind mock of last invocation for stubbing to mockingProgress does not work because of this:     when(mock(TestClass.class).getStuff()).thenReturn( X ).thenReturn(     when(mock(TestClass.class).getStuff()).thenReturn( XXX ).<TestClass>getMock().getStuff() ).getMock(),
1,0,0,1,0,0,0,1,0,0,0,1,Deleted user, 1214,1,1,0,1,0,0,1,1,0,0,1,1, Fixes #1211: Improve @deprecated JavaDoc, This pull request fixes #1211 by improving the  @deprecated  JavaDoc of  Mockito.debug()    MockitoDebugger  and  MockitoDebugger.printInvocations(Object ... mocks)  by adding the additional information on how to retrieve an actual instance of the  MockitoDebugger  interface.,
1,0,0,1,0,1,0,1,0,0,0,1,Joseph Walton, 176,1,0,0,1,0,1,0,1,0,0,0,0, Make PropertyAndSetterInjection field sorting consistent, #155 is caused by calling  Collections.sort  with a comparator that isn t always transitive  as in the case where sorting by name and sorting by type hierarchy imply different orders.  For example  with fields of type  [Iterable  Integer  Number]   it gives  Iterable == Integer  and  Iterable == Number   but also an inconsistent  Integer < Number .  I m not sure it s possible to sort consistently with a stateless  Comparator   so this change switches to a  sortSuperTypesLast  method that first sorts by name and then shuffles any subclasses to after their superclasses. It s slower  but should be deterministic. The existing tests are preserved by leaving behind a dummy  Comparator  that uses the new sort method. New tests make sure that the sorted ordering doesn t depend on the original order.  Fixes #155.,
1,1,0,1,0,0,1,1,0,0,1,1,Jakub VrÃ¡na, 1706,1,1,0,1,0,0,1,1,0,0,1,1, Fix a typo, > Hey   >  > Thanks for the contribution  this is awesome. > As you may have read  project members have somehow an opinionated view on what and how should be > Mockito  e.g. we don t want mockito to be a feature bloat. > There may be a thorough review  with feedback -> code change loop. >  > Which branch :  > - On mockito 2.x  make your pull request target  release/2.x  > - On next mockito version make your pull request target  master    check list   - [x] Read the [contributing guide](https://github.com/mockito/mockito/blob/release/2.x/.github/CONTRIBUTING.md)  - [x] PR should be motivated  i.e. what does it fix  why  and if relevant how  - [x] If possible / relevant include an example in the description  that could help all readers        including project members to get a better picture of the change  - [x] Avoid other runtime dependencies  - [x] Meaningful commit history   intention is important please rebase your commit history so that each        commit is meaningful and help the people that will explore a change in 2 years  - [x] The pull request follows coding style  - [x] Mention  Fixes #<issue number>  in the description _if relevant_  - [x] At least one commit should mention  Fixes #<issue number>  _if relevant_,
1,1,0,1,0,0,0,1,0,0,1,1,Dennis Cheung, 1146,1,0,0,1,0,1,0,0,0,0,0,1, Enable stubOnly() on @Mock annotation, Since Issue #86   withSettings() has a API stubOnly() which speed up mocked stub a lots.  In my case  stubOnly() huge amount of test overhead  stacktrace and avoid invocation footprint list grow too large and cause OOM.  However   the API is not available with  @Mock  annotation. I had to move tens of mock annotation from  @Mock Foo foo   into  Mockito mock(Foo.class  withSetting().stubOnly()) .      @Mock(stubOnly=true) public Foo lightweight        Suggest adding the above api for convenience   check list   - [x] Read the [contributing guide](https://github.com/mockito/mockito/blob/release/2.x/.github/CONTRIBUTING.md)  - [x] PR should be motivated  i.e. what does it fix  why  and if relevant how  - [x] If possible / relevant include an example in the description  that could help all readers        including project members to get a better picture of the change  - [x] Avoid other runtime dependencies  - [x] Meaningful commit history   intention is important please rebase your commit history so that each        commit is meaningful and help the people that will explore a change in 2 years  - [x] The pull request follows coding style  - [x] Mention  Fixes #<issue number>  in the description _if relevant_  - [x] At least one commit should mention  Fixes #<issue number>  _if relevant_,
1,0,0,1,0,0,0,1,0,0,0,1,Daniel Kroening, 2145,1,1,0,1,0,0,1,1,0,0,1,1, Fix in the doc for  Mocking object construction, This is a suggestion for changing the documentation for  Mocking object construction .  Previously  the documentation has suggested that  MockedConstruction  can define mock behavior and to verify static method invocations.  However  it is meant for defining mock behavior and verifying non-static method invocations.   - [X] Read the [contributing guide](https://github.com/mockito/mockito/blob/release/3.x/.github/CONTRIBUTING.md)  - [X] PR should be motivated  i.e. what does it fix  why  and if relevant how  - [ ] If possible / relevant include an example in the description  that could help all readers        including project members to get a better picture of the change  - [ ] Avoid other runtime dependencies  - [X] Meaningful commit history   intention is important please rebase your commit history so that each        commit is meaningful and help the people that will explore a change in 2 years  - [X] The pull request follows coding style  - [ ] Mention  Fixes #<issue number>  in the description _if relevant_  - [ ] At least one commit should mention  Fixes #<issue number>  _if relevant_,
1,1,0,1,0,0,1,1,0,0,1,1,Krzysztof Wolny, 413 475,1,1,0,1,0,0,1,1,0,0,1,1, Fixed method name to verifyNoMoreInteractions Typo fix, nan > Hey   >  > Thanks for the contribution  this is awesome. > As you may have read  project members have somehow an opinionated view on what and how should be > Mockito  e.g. we don t want mockito to be a feature bloat. > There may be a thorough review  with feedback -> code change loop. >  > _This block can be removed_ > _Something wrong in the template fix it here  .github/PULL_REQUEST_TEMPLATE.md   check list - [ ] PR should be motivated  i.e. what does it fix  why  and if relevant how - [ ] If possible / relevant include an example in the description  that could help all readers      including project members to get a better picture of the change - [x] Avoid other runtime dependencies - [ ] Meaningful commit history   intention is important please rebase your commit history so that each      commit is meaningful and help the people that will explore a change in 2 years - [x] Read the [contributing guide](https://github.com/mockito/mockito/blob/master/.github/CONTRIBUTING.md) - [ ] Mention  Fixes #<issue number>  in the description _if relevant_ - [x] At least one commit should mention  Fixes #<issue number>  _if relevant_,
1,1,0,1,0,1,1,1,1,0,1,1,Szczepan Faber, 1272 1282 1310 1425 1429 1433 1452 1474 1475 1523 1543 1549 1552 1783 1788 1789 1806 499 507 555 568 569 623 626 628 683 698 724 735 754 795 807 842 843 854 858 865 1018 1121 1192 1203,1,1,1,1,0,1,1,1,1,1,1,1, Strictness configurable per mock / stubbing Extra test case  javadoc update Ensure isolation of stubbings Updated documentation of timeout() and after() Updated test coverage for async verification Fixed Travis build Comprehensive test coverage for timeout() and after() Comprehensive coverage for timeout + inOrder MockitoSession API does not clean up listener when initMocks fails Added  lenient  annotation toggle Exposed new API - StubbingLookupListener Fixed issue with leftover state when stubbing with bad throwables Minimal test to repro generic issue with smart nulls Cleaned up state after stubbing misuse exception Upgraded JUnit Jupiter 5.1.1 -> 5.4.2 Fixed JUnit Jupiter parallel issue Fixed JUnit5 concurrency bug Fixes #401 - makes the JUnit runner detect unused stubs Improved exception message - fixes issue 506 JUnit rules report unused stubs - fixes #384 Ensured that MockitoJUnitRunner is thread safe wrt unused stubs detection Improved the public API of MockingDetails Updated the javadocs Ensured javadocs are correct Fixed javadoc documentation in the main class Updated release process so that Mockito can continuously deliver high quality features New API: MockingDetails.printInvocations() for debugging mock behavior Added new release workflow for release automation Exposed existing verification API so that it no longer leaks internal API Improved documentation regarding unused stubbing detection Deep stubs no longer cause unnecessary stubbing exception with JUnit runner New opt-in stubbing strictness implemented in JUnit rules Added missing Javadoc and few other tidy-ups JUnit rule strictness can be tweaked per test method Mockito JUnit Runner supports strict stubbing Safeguard for MockitoListener API New strict stubbing API - MockitoSession Enabled continuous delivery via robust mockito-release-tools project Improve and develop APIs required for framework integrators Added new public API for spring-boot use case Fixed documentation issue  added unit tests, Fixes #792  ### Problem  Today we have strict stubs feature  a key enabler for cleaner tests and improved debuggability. Strict stubs don t work well with  common stubbing  pattern. They also don t like when we call stubbed methods with unexpected arguments - even though sometimes it is legit. For more  see #792   ### Solution     java @Test public void demo() {   //1.  lenient()  method on MockSettings interface:   Foo mock = Mockito.mock(Foo.class  withSettings().lenient())     //2.  lenient()  method on Mockito class:   Mockito.lenient().when(mock.foo(1)).thenReturn(1)    Mockito.lenient().doReturn(1).when(mock).foo(1)  }      For more  see #792  ### Public API changes  - New methods:    - Mockito#lenient()    - MockSettings#lenient()    - MockCreationSettings#isLenient()    - Stubbing#getStrictness()   - New interfaces:    - BaseStubber - extracted out from existing  Stubber  interface  so that we can reuse API with  LenientStubber     - LenientStubber - instance returned by  Mockito.lenient()  - Other changes:    - Made @org.mockito.NotExtensible annotation public so that we can use it in subpackages Let s keep adding test cases to ensure great coverage of the entire behavior.  Also updated documentation so that we consistently use the  lenient  vocabulary.  Stumbled upon it when working on #1272 ### Bugfix compatibility  For certain corner cases  this bugfix may be incompatible. We believe that the exposure is minimal (corner cases only  possibly incorrect tests)  and the bugfix important. If your test fails after upgrading to Mockito version that contains this fix  please scrutinize the test - it is very likely that the test is incorrect. We apologize for any compatibility problems arising from this change. It is a hard decision to make when a bugfix changes the behavior in a way it may not be compatible with every Mockito test in the world.  ### Problem  When stubbing with answers that call different mocked methods:    java when(mock.foo()).thenAnswer(() -> { otherMock.bar() }     we need to ensure that    mock.foo()    and    otherMock.bar()    don t interfere. Prior to this bugfix  this scenario resulted in various problems like: stack overflow error  unexpected stubbings declared on different mock  unexpected invalid return type errors.  For more details  see #1279  ### Solution  The solution is based on great PR #1296 by @r-smirnov. **Huge thanks** to @r-smirnov for reporting the problem diligently  then digging into the bowels of Mockito to find a clean solution  providing excellent test cases that demonstrate the problem. When I initially saw the issue report  I thought that it s not fixable and we would close it as  documented Mockito syntax caveat . Thank you @r-smirnov for persistence and getting this fixed! While working on @ChristianSchwarz s PR  I found the current documentation confusing.  - made the documentation clear  especially about the differences between timeout() and after() - removed mentions of internal API (new Timeout() constructor)  Fixes #91 Updated tests with after() verification mode - Some existing tests for the feature did not work due to flaws in ReplyRule. Those tests (now ignored) consistently failed but succeeded only when used with reply rule. - Some existing tests had weak assertions that did not fully cover the feature. - Suggested simpler and cleaner way of implementing delayed execution via new  AsyncTesting  class  instead of  DelayedExecution . Dropping the reply rule may introduce instabilities to the CI builds  let s observe and measure before making an action.  Although we are considering deprecating  after()   we need good coverage for an existing feature even if it will be removed in the long run. We don t need private constructor on an  internal  class. Internal classes can be changed at any time based on our compatibility policy. New coverage enables us to test @ChristianSchwarz s  within . I want to see all those tests working when we replace the internal implementation with  within . Preparing for merging major overhaul in the implementation of  timeout  and  after  APIs (#936).  We need coverage before we completely replace the existing implementation. When initMocks() fails we did not clean up the session listener. This led to a confusing error message on the next attempt to create a session (next test method run). I stumbled upon this problem when attempting to configure TestNG to use strict stubbing (https://github.com/mockito/mockito-testng/issues/1).  In order to fix this cleanly I need to keep the existing functionality that protects the user from forgetting to use  finishMocking() . Hence  I still need to throw an exception if the user adds the same listener multiple times. However  in the event that the listener is dirty  I clean it up automatically instead of failing. This way we can conveniently configure an existing  lenient  setting via an annotation. See the unit test that describes the feature.     Java @Mock(lenient = true) SomeClass mock Exposed new public API based on an internal API - StubbingLookupListener - #793.  As a rule of a thumb we try to expose the internal APIs that the top level features are built upon. Since StubbingLookupListener is useful for us to implement strictness  let s get the former exposed as public API. This way we build stronger framework with the concept of  onion skin API .  This PR replaces #1466 - very nice PR from @marchpig. Due to number of changes I needed to do  I decided to reimplement the feature  rather than use the original PR. @marchpig  thank you for understanding! Fixed issue with leftover state when stubbing with bad throwables. Fixes #1514 Created a minimal test that reproduces bug with smart nulls and generics  see issue #1551 Fixes #1655 We need higher version of JUnit Jupiter to reproduce and fix #1630  Added a test to enhance coverage Fixes #1630  This fix improves Mockito JUnit Jupiter extension. However  it does not completely resolve all kinds of parallel issues when nested test classes are used. I ll open a separate ticket for it. Fixed JUnit Jupiter MockitoExtension so that it behaves correctly in a parallel execution with nested tests. I found this issue recently when working on the extension. ThreadLocal here is OK but I m happy to use a different solution if someone has a better idea.  Added a new test that was failing prior to this change. Fixes #401  This is a breaking change because JUnit runner will now fail the test class if there is an unused stubbing.  Feedback is welcome. Sorry for working on it for a long time and big number of commits. Fixes #506 - Makes JUnit rules detect unused stubs - Introduces MockitoListener API - See the use case in issue #384  - Recreated PR #527 with squashed commits This PR concludes #401 Yay!!!!  Highlights: - fixed the thread safety problem by leveraging the same API that JUnit rules used for hinting at unused stubs - removed StubbingListener API (it could not work to the thread safety levels we support in Mockito  see also #545)  Closes #332 Fixes #401 Fixes #541  highlights: - started exposing full mock creation information instead of just type to mock and extra interfaces - changed public API but only for methods that were introduced in 2.x. So it is _not_ backwards incompatible change as far as 1.10 is concerned. Polishing the javadocs  starting with this small PR:  Issue #596 - updated @since to 2.1.0 (instead 2.0.0) - added more docs around the verification collector Based on feedback from Brice. Checks out line item in #596 When merged  this will produce new version 2.2.0 and set release/2.x to continuously publish 2.2.1  2.2.2  ... as new high quality features and enhancements are merged. Hurray!  Highlights: - set next version to 2.2.0 (arbitrary number) - reworked the conditional complexity to avoid accidental releases - removed custom release version logic because it does not work (not opposed to this feature  just cleaned up the code. This feature should be implemented in version.gradle file)   - for the time being  custom version can be achieved by using Gradle env variable: ORG_GRADLE_PROJECT_version=2.3.0 (it looks like magic but it is a real feature from the Gradle book  ) - added basic docs around testing the release process (it s way too hard now) For motivation  see issue #543 The purpose of this RB is to give you heads-up about the improvements to the release automation that I work on. The algorithm is implemented and will not change much. Documentation  edge case unit tests and fixing runnability from Gradle are pending (Travis CI will fail on this PR).  The goal of the new  release-workflow  plugin is to able to express the release automation in the build.gradle file like that:      groovy releaseWorkflow {     step releaseNeeded     onlyIf { releaseNeeded.needed }     step bintrayUpload     step pullCommits     step configureGenericGitUser  cleanup: restoreGitUser     step commitReleaseNotes  rollback: resetReleaseNotes     step tagNewVersion  rollback: removeNewTag     step bumpVersion  rollback: unbumpVersion     step pushChanges }      More over  it will be very easy to test out the release locally or even individual release steps:      ./gradlew release -PdryRun ./gradlew pullCommits -PsingleStep See motivation and plan in #730 Improved documentation regarding unused stubbing detection  fixes #609 Fixes #756 New API (for rationale  see #769  for code review history see #770):     java //Existing API: @Rule public MockitoRule mockito = MockitoJUnit.rule()  //Proposed improvements: rule().strictness(Strictness.LENIENT) rule().strictness(Strictness.WARN)       // <-- is the default rule().strictness(Strictness.STRICT_STUBS)  // <-- Mockito 3.0 default      What  strict stubbing  means? - Improved debuggability: the test fails early when code under test invokes stubbed method with different arguments. - Cleaner tests without unnecessary stubbings: the test fails when there are any unused stubs declared. - Cleaner  more DRY tests ( Don t Repeat Yourself ): If you use Mockito.verifyNoMoreInteractions() you no longer need to explicitly verify stubbed invocations. They are automatically verified.  For background and motivation  check out [Szczepan s article on LinkedIn](https://www.linkedin.com/pulse/curious-how-get-even-cleaner-tests-new-mockito-features-faber). 1. No API / no behavior changes. 2. Publicly visible changes:   - Added missing Javadoc and updated an existing one for MockitoException and MockitoAssertionError classes 3. Remaining changes  refactoring:  - Rename job for consistency  - Removed some unnecessary code  - Made the tests more stable See the design and rationale at #840  Please review! Background:  - Mockito  strictness  is explained in #769  - Since 2.3.x Mockito JUnit Rules already provide opt-in  strict stubbing  capability  [see the javadoc](https://static.javadoc.io/org.mockito/mockito-core/2.4.5/org/mockito/junit/MockitoRule.html#strictness(org.mockito.quality.Strictness)).  This change adds new opt-in  strict stubbing  support for Mockito JUnit Runner. This behavior is tentatively planned to be the default in Mockito v3. Example usage:     java //Note  StrictStubs  inner class: @RunWith(MockitoJUnitRunner.StrictStubs.class) public class ExampleTest {     // ... }            The behavior added by the StrictStubs runner is documented in the [javadoc](https://static.javadoc.io/org.mockito/mockito-core/2.4.5/org/mockito/junit/MockitoRule.html#strictness(org.mockito.quality.Strictness)). See also Javadoc improvements in code changes for this PR. The general direction of Mockito  strictness  is documented in #769. Reminds user if he forgets about  removeListener()  when working with [MockitoListener API](https://static.javadoc.io/org.mockito/mockito-core/2.5.0/org/mockito/MockitoFramework.html#addListener(org.mockito.listeners.MockitoListener)).  - Added a safeguard that reminds users to clean up MockitoListeners via removeListener() method. The implementation is very simple  checking if the type of the listener is already added. I found out about this problem when working on strict stubbing support without JUnit runner. - This change makes MockitoListener API safer. It s easy to leak state which we have encountered in our own test suite. - If we encounter legit use cases for adding the same listener type  we can remove the safeguard or updated it  The PR also contains a couple of refactorings and tidy-ups. I hope it s ok. See proposed design at #857  The code is reviewable  especially new public API. Please give feedback! More work is pending.  Current status:  - [x]  address @bric3 feedback   - [x] getter   - [x] javadoc - [x] review documentation for consistency   - [x] Mockito.session()   - [x] MockitoSessionBuilder   - [x] Strictness   - [x] MockitoHint   - [x] PotentialStubbingProblem   - [x] UnnecessaryStubbingException   - [x] MockitoJUnitRunner and subclasses   - [x] MockitoSession   - [x] MockitoRule - [x] Add / update mentions in the main Mockito class - [x] add validate mockito usage (should be very easy) - [x] Try making rules/runner use the session. They already reuse the code  they just don t use the API directly. Created #898 to track this work. - [x] Address @TimvdLippe feedback - [x] Create concurrent test (multiple sessions active in different threads) - [x] (non-code change  not blocking merge) GitHub tickets linked from source code should be better documented #769  #384. Alternatively  create ticket for tracking. - Continuous Delivery Pipeline 2.0 (#911) almost implemented! - Removed tons of release logic complexity  now all that is a part of general purpose  mockito release tools  project. - The new release automation should be much easier to test. ### Problem  Mockito does not do static mocking at the moment  Powermockito does. Powermockito uses a lot of internal Mockito APIs exposing the community to issues and wasted productivity on version upgrades. We want Mockito APIs to be easily extensible by framework integrators such us Powermockito without compromising API simplicity and consistency.  All proposed changes are backwards compatible in accordance to Mockito s compatibility contract (in short: limited changes to org.mockito.* types  freedom to change org.mockito.internal.*).  ### Public API changes  The full discussion on the use cases  implementation options and decisions is in #1110 ticket.  1. New public method for creating mock creation settings object:     java Mockito.withSettings().name(â€œmy mockâ€).build(Foo.class)       2. Framework integrators can now provide custom MockHandler via    MockMaker#getMockHandler()   . Previously  it we didnâ€™t offer this capability because we didnâ€™t have convincing use cases that it was needed.  ### Public API considerations  1. Framework integrators may **not** provide custom implementation of    InvocationContainer    at this stage. This part of API is accessible via public    MockMaker#getMockHandler().getInvocationContainer()    method. There are no convincing use cases that exposing this new public API is needed. Not intended for merging yet  submitted for visibility.  - for design and rationale  see #1191 - for usage  see  VerificationStartedListenerTest  class  This is still experimental so refactorings  error handling  javadoc is missing. - While working on new verification started listeners (#1191) I found an instance of incorrect documentation. I added unit tests and simplified the documentation. - Currently  contrary to what the Javadoc said  we do guarantee the order in which invocation listeners get notified. Some of our users might have started to depend on this behavior. I added unit tests and fixed the Javadoc. In general  it is seems useful to guarantee the order. This way  the API is more predictable  easier to use.,
1,1,0,1,0,0,1,1,0,0,1,1,Stefan Bohn, 2179,0,0,0,1,0,0,0,1,0,0,0,1, Fix reversed order of verify parameters, For consistency the parameters of the method MockedStatic.verify(VerificationMode  Verification) have been swapped to MockedStatic.verify(Verification  VerificationMode) as this order is already used in Mockito.verify(T  VerificationMode)  Fixes: #2173  check list   - [x] Read the [contributing guide](https://github.com/mockito/mockito/blob/release/3.x/.github/CONTRIBUTING.md)  - [x] PR should be motivated  i.e. what does it fix  why  and if relevant how  - [x] If possible / relevant include an example in the description  that could help all readers        including project members to get a better picture of the change  - [x] Avoid other runtime dependencies  - [x] Meaningful commit history   intention is important please rebase your commit history so that each        commit is meaningful and help the people that will explore a change in 2 years  - [x] The pull request follows coding style  - [x] Mention  Fixes #<issue number>  in the description _if relevant_  - [x] At least one commit should mention  Fixes #<issue number>  _if relevant_,
1,1,0,1,0,0,1,1,0,0,0,1,Matthew Ouyang, 1596,0,0,0,0,0,0,1,0,0,0,0,1, Fixes #1578: outer class mocks unavailable from inner class, I opened issue #1578 a few weeks ago that went without an correspondence  so I apologize if submitting a PR isn t the ideal method of moving this issue forward.  However I am hoping I can get this fix incorporated into an official version without implementing temporary workarounds.  The PR should clearly show the issue I am trying to fix  but I had to introduce a testCompile snapshot dependency.  The dependent project has a fix required to demonstrate the issue within Mockito but it unfortunately has not been incorporated into an official release  and I can t think of another way to reproduce the issue.  I have contacted the owner of the dependent project but I haven t received a response from them either.  I am looking for guidance on next steps for what I believe to be regression (reported to be working in #353).  The only other solution I can think of is to merge this without a unit test but I highly doubt that is desirable.  _Git Commit Message_ - problem - JUnitRule detects an unfinished mocking session when an inner class is detected - fix - if a MockitoSession has been established for JUnitRule  then use that and init mocks of the inner class. - tests - within an inner class ... ensure mocks are accessible  override outer class values when desired  retain original values if not overwritten - demonstrated with de.bechte.junit:junit-hierarchicalcontextrunner:4.12.2-SNAPSHOT,
1,0,0,0,0,1,0,1,0,0,0,1,Nikolas Falco, 1585,1,1,1,1,0,1,0,1,1,0,0,0, Fix #1584 where MultipleParentClassLoader lacks of classloaders of superclasses, The MultipleParentClassLoader is now composed also with classloaders of supertypes of the mockedType so in OSGi is able to load all declared types in the hierarchy.,
1,0,0,1,0,0,0,1,0,0,0,1,Carlos Aguayo, 261 264,1,1,0,1,0,0,1,1,0,0,1,1, Fixes #260: Typo in documentation Fix typo in docs  missing breaklines., Very minor typo in documentation: https://github.com/mockito/mockito/issues/260  There s an extra  at  (@) in the documentation.  Before it reads:  Annotating the JUnit test class with a @RunWith(@MockitoJUnitRunner.class)   After it reads:  Annotating the JUnit test class with a @RunWith(MockitoJUnitRunner.class)   ![image](https://cloud.githubusercontent.com/assets/338917/8634099/6c7f5264-27b8-11e5-93d9-98b725c9f749.png) http://mockito.org/  Elements 32 and 33 show inline because they are missing a breakline.  ![image](https://cloud.githubusercontent.com/assets/338917/8639441/43dba808-28a8-11e5-8e9e-5bfc9dcc92bb.png),
1,0,0,0,0,1,0,1,0,0,0,1,Philipp Jardas, 429,1,0,0,0,0,1,0,1,1,0,0,1, Added default answer for java.util.stream.Stream, I hope the description says it all. :-)  The new Java 8 based code only uses reflection  so the library still compiles and runs under older Java versions.,
1,0,0,1,0,1,1,1,0,0,0,1,Xu Tan, 1619,1,1,1,1,0,1,1,1,1,0,1,1, New API to clean up all inline mocks after test, In certain specific  rare scenarios (issue #1614) inline mocking causes memory leaks. There is no clean way to mitigate this problem completely. Hence  we introduced a new API to explicitly clear mock state (only make sense in inline mocking!):     java public class ExampleTest {       @After      public void clearMocks() {          Mockito.framework().clearInlineMocks()       }       @Test      public void someTest() {          //...      }  }      Due to the introduction of map from weak reference from mock instance to its invocation handler  Mockito became vulnerable to memory leaks as there are multiple situations where Mockito could unintentionally hold strong references to mock instances in the map record. The strong references could be through spiedInstance for spies  and arguments used to facilitate method stubbing.  Mockito could never know if the arguments passed in for method stubbing are also strongly referenced somewhere else or not  so Mockito needs to save a strong reference to these arguments to avoid premature GC. Therefore to solve cyclic strong references through arguments Mockito needs to explicitly know when mocks are out of their life  and clean up all internal strong references associated with them.    Fixes #1532 and #1533.,
1,0,0,1,0,1,0,1,0,0,0,1,Stephan Schroevers, 1270 1693 782 783,1,1,1,1,0,1,1,1,1,0,1,1, Cleaner code for Mockito users by better integration with static code checkers  more @CheckReturnValue Make  MockitoNotExtensible  service-loadable Introduce default answers for primitive Optionals/Streams Simplify  ReturnsEmptyValuesTest, Builds on #1130  #1228. This way Error Prone can find the plugin when  mockito-errorprone  is added to the annotation processor classpath.  Fixes #1692. I introduced  #invokeNullaryFactoryMethod  to remove some of the existing code duplication  but am unhappy about the _new_ duplication  especially in the test code. What s your view on introducing deduplicating logic in test code? Also  the singleton fields in  JavaEightUtil  could be replaced with a  ConcurrentMap<String  Object>  (i.e. a map from FQCNs to singletons). If you agree  I d love to reduce the size of this PR. As [discussed](https://github.com/mockito/mockito/pull/782#discussion_r89658266) in the comments under #782. Longer term this approach could be replaced with a proper test parametrization framework  but then at least the foundation has been laid.,
1,0,0,1,0,0,0,1,0,0,0,1,Michael Pinnegar, 424,1,1,0,1,0,0,1,1,0,0,1,1, Inorder timeouts, *Fixes issue https://code.google.com/archive/p/mockito/issues/292   *Updated code provided by https://github.com/sirchia in PR #20  Closes #20,
1,0,0,1,0,1,0,1,0,0,0,1,Andrew Ash, 1739,1,0,0,1,0,1,0,1,0,0,1,0, Consistent punctuation in hints list for UnfinishedStubbingException, Previously the numbered list had two periods and a colon after the three numbers.  After  it consistently uses dots like other suggestions  i.e. missingMethodInvocation,
1,0,0,1,0,1,0,1,0,0,0,0,Myrle Krantz, 1119,1,0,0,1,0,0,0,1,1,0,0,0, Made it possible to delay the return of a mock or spy.  (#1117), This is a useful aid in debugging race conditions and other synchronicity problems.,
0,0,0,1,0,0,0,1,0,0,0,0,Vinicius Scheidegger, 1938,1,0,0,0,0,0,0,1,0,0,0,0, Update javadoc - remove deprecated class, The javadoc is misleading - pointing to the deprecated class ReturnsElementsOf that should later be internal or moved,
1,0,0,1,0,1,0,1,0,0,0,1,Tom Ball, 1715 306,1,1,0,1,0,1,0,1,1,0,0,1, Fixes #298: replaces Objenesis references from stubbing classes with plugin equivalents. Eliminate direct dependency on ObjenesisInstantiator, This enables the iOS Mockito plugin (https://github.com/google/j2objc/tree/master/testing/mockito) to upgrade to v2. Updated InstantiatorProvider to be a plug-in  to eliminate direct dependency on ObjenesisInstantiator. This allows Mockito to be used by runtimes that don t execute bytecode  such as j2objc-translated code on iOS.,
1,0,0,1,0,0,0,1,0,0,0,1,Ivan Vershinin, 41,0,0,0,1,0,1,0,1,1,0,0,0, New  getArgumentAt  method for convenient implementation of custom Answers, The problem is when i need to use answers  I quite often need to cast these arguments. I propose two methods in InvocationOnMock  so we can get two arguments of method typesafely  so this piece of code       java @SuppressWarnings( unchecked )   doAnswer(new Answer() {       public Object answer(InvocationOnMock invocation) {           Object[] args = invocation.getArguments()            int count  = (int)args[1]           //do something       }})   .when(mock).someMethod()       will be better:      java   doAnswer(new Answer() {       public Object answer(InvocationOnMock invocation) {            int count  = invocation.getArgumentAt(1  int.class)           //do something       }})   .when(mock).someMethod(),
1,0,0,1,0,1,0,1,0,0,1,1,Marcin ZajÄ…czkowski, 252 861 1007 1008 1122 1202,1,1,1,1,0,1,0,1,1,0,1,1, [#251] Migrate Fest Assert code to AssertJ Backport  release/2.x  changes to master (20161231) + fix for #860 Fix test failing with Java 9-ea+146+ Sample usage of soft assertions Made it possible to delay the return of a mock or spy (#1117) [#1202] Java 9 CI build for Mockito 2.x, Fixes #251 Backport  release/2.x  changes to master + the fix for #860. Stack trace in JDK part contains also module name:      java.lang.AssertionError:  Expecting:   [MockitoHint] 1. Unused -> at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)  to match pattern:   \[MockitoHint\] 1\. Unused \-\> at [\w\.]+\.reflect\.NativeMethodAccessorImpl\.invoke0\(.*Native Method\)       The new regexp handles both variants. Could be propagated by the way also in other similar places. A cherry-picked version of #1119 for the 2.x branch. ## Summary  Provide Java 9 Travis build to ensure Java 9 compatibility in at least tested use cases.  Support for Java 9 was improved in Gradle 4.x and that version is being used. Due to some issues with newer Gradle versions (#1198) some other configuration changes were required. As well as JaCoCo version has been bump (https://travis-ci.org/mockito/mockito/jobs/284996316#L799-L816).  Fixes #1198.  ## Check list   - [x] Read the [contributing guide](https://github.com/mockito/mockito/blob/release/2.x/.github/CONTRIBUTING.md)  - [x] PR should be motivated  i.e. what does it fix  why  and if relevant how  - [x] If possible / relevant include an example in the description  that could help all readers        including project members to get a better picture of the change  - [x] Avoid other runtime dependencies  - [x] Meaningful commit history   intention is important please rebase your commit history so that each        commit is meaningful and help the people that will explore a change in 2 years  - [x] The pull request follows coding style  - [x] Mention  Fixes #<issue number>  in the description _if relevant_  - [x] At least one commit should mention  Fixes #<issue number>  _if relevant_,
1,0,0,0,0,1,0,1,0,0,0,0,Stefano Cordio, 1868,1,0,0,1,0,1,1,1,0,0,1,1, Update Mockito version number for deletion of deprecated classes, nan,
1,1,0,1,0,1,1,1,1,0,1,1,Rafael Winterhalter, 1257 1258 1355 1368 1369 1377 1378 1582 270 1955 1968 1971 1974 1989 1996 470 2003 2004 2006 2013 2017 2018 2020 2021 2023 2034 2042 2046 2051 2098 2194 648 2283 805 823 864 875 891 893 902 920 1012 1090 1128 1136 1181 1186 1216 1217,1,1,1,1,1,1,1,1,1,1,1,1, Fixes #1254 and #1256: improved check for self-invocation. Prevent class loading race condition Use java.lang.MethodHandles.Lookup::defineClass Resolve the correct protection domain for the codegen package when using reflection. Performance improvements Update Byte Buddy and cache some expensive values Avoid circularity: avoid endless loop during mock creation Fix #1577: Refactoring naming rule for sealed packages to better work with the Java module system Issue #268: Added support for generic arrays as return types. Mockito #1013: Defines and implements API for static mocking. Fixes #1967: Correctly handle mocks with limited life-cycle in listeners. Add support for creating constructors without using Objenesis (and unsafe API) Fixes #1855 and #939: improve error message when the inline mock maker cannot be used. Do not pass static mocks to regular listener callback. Add invoker API to allow for alternative invocation modes to better support the module system. Refactored mock cache to be non-blocking. Pre release 3.5.0 Pre release 3.5.0 Introduce animal sniffer [ci maven-central-release] Constructor dispatch Only enable mocking of types right before instantiation to avoid circular interception of constructor creation. Only enable mocking of types right before instantiation to avoid circular interception of constructor creation. Constructor dispatch Constructor dispatch Initializes classes prior to instrumentation to avoid uncontrolled code execution. Escape mock during method dispatch on mock to avoid premature garbage collection. Mock resolver plugin Do not exclude synthetic constructors from instrumentation. Fixes #2040. Update to OpenJDK 15. Improve error message if initializer fails. Add API for clearing mocks. Added InlineByteBuddyMockMaker which uses the instrumentation API for redefining classes and inlining the mocking logic. Improve error messages in case of missing dependency on Byte Buddy and avoid hard dependency on Byte Buddy in member accessor. Never throw mockito exceptions from a plugin type s constructor Only resolve instrumented method after validating that an instance isâ€¦ Updated to Byte Buddy 1.6.0 Update Byte Buddy and enable injecting loading strategy for Android Update to Byte Buddy 1.6.4: Fixes bridge method resolution for generic types Add detection for Android environments and give warnings if used incorrectly. Corrected documentation. Fix TypeCache dead lock Added subproject for configuration-free inline mock making. Do not suppress instrumentation exceptions Fixes #1083: Interfaces only declare toString implicitly and should tâ€¦ Improve detection on non-mockable types - byte buddy 1.6.14->1.7.0 Fixes #1135: Properly resolve visibility bridges. #1179: Fix performance regression caused by use of method graph compiler. Compare method of graph to defined form of method. Adresses #1206: allow opting out from annotation copying within mocks. Fixes #1183: Make override check more forgiving to accomondate Kotlin compile patterns., Better checks for recursive calls and guards internally used JDK types.  Fixes #1254  Fixes #1256 Allow singleton locking in context with class loading races.  Fixes #1067 Use java.lang.MethodHandles.Lookup::defineClass if this mechanism is available on the current JVM. This might not work when interoperating with foreign modules  if those modules do not open and export their types  most prominently  the Java core modules where there are introduced issues with serialization.  This introduces a change in behavior for Mockito when using Java 9+. Unfortunately  I think that this is necessary for Mockito to continue to function after introduction of the JPMS. For now  it seems like this limitation only affects working with serializability in combination with platform types what is not too bad but there is a chance that we will discover issues once this new mechanism is picked up by the community. Fixes #1367. Use less expensive method graph compiler for inline mock maker. Update Byte Buddy for general performance improvements and bug fixes. Fixes #1364. Also fixes javadoc warning. This avoids the reallocation of certain objects that are expensive to compute. Also  Byte Buddy is updated. If certain types a type for the first time during instrumentation while our mocking engine relies on the same types  this can cause a circularity as checking if an instance is a mock requires instances of the latter types what again returns to the latter mock checking routine what causes an endless loop. (Described in comment.) Fixes #1240.  It is a bit difficult to reproduce this issue in our tests. It mainly happens with classes generated by Kotlin or Scala and requires the inline mock maker and a JDK 9 or older. If we want to add such a test  we can copy the test from https://github.com/guenhter/mockito-final-class-kotlin-problem The Java module system consideres packages of all named modules to be sealed. This results in the naming strategy to rename classes such that they cannot subclass package-private types. Solves https://github.com/mockito/mockito/issues/268 by explicitly checking for return types that represent a generic array and by resolving for the array s component type. Fixes #1013 - allows for static method mocking in Mockito. Due to the limited lifetime of static mocks  they cannot be validated within a Mockito session since they might have expired when the validation is applied. This patch excludes static mocks from all validation. To support static mocks in the regular session validation  we would rather need to trigger the validation upon release of any static mock. This PR adds code to constructors to allow short-wiring a constructor without avoiding to call it  thus making the use of Objenesis obsolete. This is desired since Objenesis relies on Unsafe API which is deprecated and will be removed in a future release.  The idea is as follows: Any constructor for a class:     java class Foo extends Bar {   Foo() {     super(somethingWithSideeffect())    } }      is rewritten as follows:     java class Foo {   Foo() {     if (MockDispatcher.isMockedConstruction()) {       super(null)        return      }     super(somethingWithSideeffect())    } }      The mock dispatcher then applies a thead-local check to see if the current construction is supposed to be short-wired and suppresses the original construction in such a case. The check is repeated along the super class hierarchy until reaching the  Object  constructor which is by definition side-effect free. As a result  a mock was created without triggering any user code and without relying on Unsafe API. Improves the error message and does not create a hard dependency on the compiler module. It also points out that Byte Buddy can now emulate the attachment API using JNA if it s added to the class path. Does not include static mocks in regular listener logic as it might distort existing mock collectors that do not expect scoped mocks. Fixes #1988.  We have passed  Class  objects to the listener to indicate a static mock. The class object is of course itself not a regular mock and it s cleaner to create a callback method of it s own. This way  existing listeners remain logically backwards compatible  including our own listener that is used within the JUnit runner (we have only tested the rule  I added a test for the runner  too). Adds a  MemberAccessor  abstraction for accessing fields  methods and constructors where the default implementation  ReflectionMemberAccessor  implements the current behavior of using reflection and  setAccessible .   Also  this PR adds a new implementation  ModuleMemberAccessor  where the instrumentation API is leveraged to open modules to Mockito before using method handles to access any such member. This way  module boundaries are no longer stopping Mockito from functioning on Java 9 and onwards. Since the instrumentation API is already used by the inline-mock-maker  it is enabled for this mock maker by default. The previous cache used a lock to unify concurrency and weak references. Instead  keys are now explicitly wrapped using weak references and similarly to the functioning of a weak hash map  the entries are polled upon accessing the cache. This avoids blocking. Merged several pull requests into a branch prior to release. Merged several pull requests into a branch prior to release. Introduces animal sniffer with exclusion of inline-mock-maker classes which would never be present on Android. Avoids calling invoke/invokeExact methods of handles directly but rather puts the invocations into generated code to avoid breaking Android builds. Use constructor instantiation if explicitly specified. Fixes #2015. Fixes #2015. Adds error message to class loader setups that do not work with the inline mock maker. Fixes recursive constructor invocation. Avoids reflective access warning when using instrumentation-based member accessor. Fixes #2011 - triggeres initializers explicitly. Under heavy optimization mocks might get garbage collected during the dispatching of a mocked method if the mock instance is not used after this method dispatch. To avoid this  we escape the mock instance during the dispatch to make sure that the GC cannot collect the object.  Fixes #1802. Adds a plugin to allow for adding one or multiple mock resolvers. This way  instances that are provided to Mockito s DSL do no longer require to be the actual mocks but can also be proxies of mocks what is something already being applied by frameworks such as Spring.  This works today with the subclass mock maker by accident as we read the mock state from the mock instance via a method which gets proxied. If we ever find a more private appraoch this would however break Spring s Mockito use and it is already broken with the inline mock maker.  By this SPI  Spring could add an unproxy resolver to its Mockito build-up and make it s proxied mocks compatible with Mockito. Other frameworks could use the same approach if desired as this SPI is generic.  Closes #1980 Byte Buddy does exclude synthetic members by default as they normally provide necessary infrastructure outside of business logic (e.g. bridge methods). For constructor instrumentation  it is however crucial that no code is called during mock creation and that fields are copied during spy creation. Use Java 15 in builds for most recent Java version. Non-initializable classes can never be mocked  an error message should help guide on these issues. By clearing mocks  caches are emptied and instrumentations are reversed. Inline mocks allow for creating mocks of final types and final methods within any type. The inline mock engine also makes the mocking type invisible such that  mock(Foo.class).getClass() == Foo.class . Exceptions need to be made for abstract types and for types with serialization requirements where final methods are still instrumented but where a subclass needs to be created nevertheless. There are however few limitations of the inline mock engine that do not apply for the subclass mock engine: 1. It is no longer possible to mock  native  methods which do not provide any byte code that can be manipulated. 2. Synchronized methods remain synchronized as the instrumentation API does not allow the changing of modifiers.  The final mock engine is activated just like any other custom mock engine by placing an indicator file into the root folder. To make this more convenient  an alias mechanism was added where the mock type name can be referenced by _inline_. This improves error messages in case the dependency is not set up correctly. This should rarely happen but especially with the module system gaining traction  this might trigger a few bugs that we can better explain this way. Throwing a  MockitoException  from a mock maker constructor will cause the stack trace cleaning to be applied which itself relies on the plugin registry which is not yet initialized during the mock maker plugin s creation. This is both a performance improvement and a way of ensuring that no stack overflow error occurs upon looking up a  Method  instance which requires using a  HashMap  which causes an infitite loop upon mocking the hash map type. Fixes #818. Updated Byte Buddy  several performance and API improvements. Also with much better Android support. This enables Byte Buddy s new injection strategy for Android which loads types within a target class loader instead of creating a new one. Also  this updates Byte Buddy with a few bug fixes. Fixes #874. The documentation gave an incorrect configuration example. Also  warnings were added for using Android on a non-Android environment. I could trace the problem to more eager resolution of types in Java u31 upon loading where concurrent mock creation with locking on the class level causes a dead lock. This can happen in other VM implementations but can be solved with a more granular lock on our type cache.  This fixes https://github.com/mockito/mockito/issues/892. Added a preconfiguration for using the inline mock maker as a convenience artifact that can be included instead of creating the plugin file. This is very helpful when creating multi-module projects where the mock maker file has to repeated many times.  Once we choose to change the mock maker to be default or enable programmatic access  we can decide to drop this artifact similar to  mockito-all  from version one. Rather propagate them to mock maker that attempts instrumentation. Addresses #1005. â€¦herefore override it explicitly from the inline mock maker. Stronger assertions on class loader origin when choosing what methods are mockable. Resolve the method hierarchy by Byte Buddy s method graph compiler to properly handle bridge methods which require a full method hierarchy analysis to detect. In order to properly discover visibility bridges  we have to run a full analysis of the method graph. The compilation of this method graph is rather expensive and we require to cache a computed graph. The caching is however non-trivial as it references classes which might be unloaded. In order to avoid a leak  we cache classes using non-strong references.  This requires some real-world experience to discover if this caching mechanism suffices. Fixes #1180: Compare against non-generic method when deciding if a method should be stubbed. The  MockSettings  now include an option to disable copying of annotations to mock classes. The override check implies Java compile patterns such that Kotlin method resolutions could fail for void return types which do not fit into Java s reference-type only generic hierarchies. This PR eases this restriction to fix this resolution for Kotlin.  I added the test case of the reported issue as a reference.,
1,0,0,1,0,1,0,1,0,0,0,1,Ivo Å mÃ­d, 1430,1,1,0,1,0,1,1,1,0,0,0,1, Allow mockito-logger to be configurable as Mockito extension, Hi  we have many of legacy tests that do over-mocking code base - lots of unused mocking there (we are cleaning it slowly). We have user  @MockitoSettings(strictness = Strictness.WARN)  switch to log and not fail in this situactions. By default all logs are printed out to console using  System.out.println  and this make us trouble because we have  silent  profile at CI server which is configured to silent Loggers / as you expect sith  .println  we are not trully silent in this case :] Thats why I have created this PR proposal and want to know what do you think. Thx  Ivos,
1,0,0,1,0,1,0,1,0,0,0,1,Ross Black, 113,0,0,0,0,0,1,0,1,1,0,0,1, Improved exception handling of AdditionalAnswers#delegatesTo, When using the AdditionalAnswers#delegatesTo method  exceptions thrown by the delegate are wrapped in InvocationTargetException due to invocation via Method. Instead  the original exception from the delegate should be propagated to the caller.,
1,0,0,1,0,0,0,1,0,0,1,1,Guillermo Pascual, 1773,0,0,0,1,0,0,0,1,0,0,0,0, Fixes #1769: Clarify default strict stubbing behaviour in 3.0.0, Similar to https://github.com/mockito/mockito/pull/1745 as requested by @TimvdLippe in https://github.com/mockito/mockito/issues/1769  Closes #1769,
1,1,0,1,0,1,1,1,0,0,1,1,Per Lundberg, 1670 1991 2175,1,1,0,1,0,0,1,1,1,0,1,1, Add support for Answer6 and VoidAnswer6 Mockito.verify(): fix typo in Javadoc ArgumentMatches: fix Javadoc typo/grammar, Regretfully  I ran into a case where I needed to mock a six-argument method. One can of course claim that such methods _ought not to exist_  but sadly  this is not always the reality and I think that some pragmatism is useful in tools like Mockito  so here is my attempt at adding support for it.  Of course  it s possible to use the plain  Answer  interface in this case  but adding a dedicated  Answer6  interface makes it more convenient on the user   Answer  is a quite raw interface.  (I m not sure if this should target the 2.x release or  master  also  but feel free to cherry-pick as needed after review/merge.) I noted this while reading the Javadocs in my IDE  they were referring to a  get(0)  reference which isn t quite easy to grasp in this context. :see_no_evil: After looking at this class a bit more  I think it s just a copy-paste mistake from this line in the class-level Javadocs: https://github.com/mockito/mockito/blob/release/3.x/src/main/java/org/mockito/Mockito.java#L212 I started out with noticing the  safer that it was  part which felt like a typo. Then I realized there were perhaps more errors in this sentence (which was duplicated in multiple places in this file). Please verify that I understood the intent of this comment correctly  but my hope is that this is now the more correct way to express this.  Again  thanks for a great framework! :bow:,
0,0,0,1,0,0,0,1,0,0,0,0,Jean-Michel Leclercq, 1881,0,0,0,1,0,0,0,0,0,0,0,0, Fix UnnecessaryStubbingException javadoc, Fix #1880,
1,0,0,1,0,1,0,1,0,0,0,1,Erhard Pointl, 1951 1058 1060 1075,1,1,0,1,1,1,1,1,1,0,1,1, Use errorprone 2.4.0 Test code refactoring - updated assertj test dependency from 1.x to 2.6.0 Fixed  typos across the codebase Streamline assertj and junit4 usage in gradle files and update assertj (v2.7.0), in order to get java14 ready. see https://github.com/google/error-prone/releases/tag/v2.4.0 for details. make use of assertj 2.6.0 since java 7 is used now for building mockito and assertj 1.x is no longer under development. nan It looks like I missed some occurrences of assertj-core 1.7.1 in #1058. Therefore I thought it might be a good idea to add a  dependencies.gradle  file which defines certain dependencies (for now assertj and junit4).,
1,1,0,1,0,0,1,1,0,0,1,1,Fabian Mendez, 1854,1,0,0,1,0,1,1,0,0,0,0,0, Fixes #1853: Allow @MockitoSettings to be inherited, - [X] Read the [contributing guide](https://github.com/mockito/mockito/blob/release/3.x/.github/CONTRIBUTING.md)  - [X] PR should be motivated  i.e. what does it fix  why  and if relevant how  - [X] If possible / relevant include an example in the description  that could help all readers        including project members to get a better picture of the change  - [X] Avoid other runtime dependencies  - [X] Meaningful commit history   intention is important please rebase your commit history so that each        commit is meaningful and help the people that will explore a change in 2 years  - [X] The pull request follows coding style  - [X] Mention  Fixes #<issue number>  in the description _if relevant_  - [X] At least one commit should mention  Fixes #<issue number>  _if relevant_,
1,0,0,1,0,1,0,1,0,0,0,1,Gunnar Wagenknecht, 65,1,0,0,0,0,1,0,1,1,0,0,1, Refactoring: Cleanup ignores and fix 1.5 compatibility, This branch contains a few cleanups I had to do after importing mockito: - There are a few more ignores required for Eclipse.  - As Mockito is configured for 1.5 source compatibility it should adhere to it. Therefore I removed the @Override annotation where it would cause compile errors on 1.5,
